# .NET

## .NET

**.NET** is a development framework—not just a language. It includes the Common Language Runtime (CLR), a vast class library, and support for multiple languages (e.g., C#, F#, VB.NET). Its deep integration with Windows internals makes it a powerful choice for red team tooling, loaders, and post-exploitation frameworks.

## .NET & Red Teaming

.NET provides full access to native Windows APIs, making it ideal for crafting custom tools that operate at a low level. Offensive frameworks like **SharpHound**, **Covenant**, and **Seatbelt** leverage .NET for enumeration, credential theft, and lateral movement. Compared to PowerShell, .NET binaries often bypass some logging mechanisms, especially when custom-compiled and obfuscated.

However, modern AV/EDR platforms have become increasingly effective at monitoring .NET behavior. Unlike PowerShell, .NET lacks native in-memory script execution (i.e., no cradles), so payloads must be compiled and delivered as binaries, increasing friction and detection opportunities.

## .NET vs PowerShell

<table><thead><tr><th width="163.6666259765625">Aspect</th><th>PowerShell</th><th>.NET</th></tr></thead><tbody><tr><td><strong>Ease of Use</strong></td><td>No compilation, easy scripting</td><td>Requires coding and compilation</td></tr><tr><td><strong>Detection Surface</strong></td><td>High (ScriptBlock, AMSI, logging)</td><td>Lower if custom; fewer built-ins</td></tr><tr><td><strong>Delivery</strong></td><td>Download-and-execute (trivial)</td><td>Requires binary drop or injection</td></tr><tr><td><strong>Logging</strong></td><td>Extensive (incl. Transcription)</td><td>Less structured, but process logging</td></tr></tbody></table>

## Considerations

Obfuscation helps reduce static detections, but behavior-based EDR can still flag suspicious patterns. Testing in a sandboxed or lab environment is essential.

{% tabs %}
{% tab title="Codecepticon" %}
[Codecepticon](https://github.com/sadreck/Codecepticon) is a source-level obfuscator for C#/VB.NET:
{% endtab %}

{% tab title="ConfuserEx" %}
[ConfuserEx](https://github.com/mkaring/ConfuserEx) is a binary-level obfuscator for .NET executables and libraries:
{% endtab %}
{% endtabs %}

Even with obfuscation, assume behavioral detection is in play—especially for common post-ex tools. For mature operations, consider custom development, sandbox testing, and minimal functionality per binary.
