---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# ADSearch

[ADSearch](https://github.com/tomcarver16/ADSearch) is a C# tool designed to work seamlessly with C2 frameworks like Cobalt Strike and Sliver using `execute-assembly`, enabling efficient and stealthy in-memory Active Directory enumeration. Unlike PowerShell-based tools like PowerView, which often rely on disk or process creation, ADSearch can be loaded directly into memory through the C2's implant. It supports custom LDAP queries, LDAPS connections, and JSON output for structured data collection.

## AD Enumeration

{% tabs %}
{% tab title="Users" %}
{% code overflow="wrap" %}
```bash
# User enumeration
ADSearch.exe --users

# Same with LDAP query
ADSearch.exe '--search "(&(objectCategory=person)(objectClass=user))"'

# Filter attributes
ADSearch.exe '--search "(samaccountname=administrator)" --attributes cn,logoncount,description'
```
{% endcode %}
{% endtab %}

{% tab title="Computers" %}
{% code overflow="wrap" %}
```bash
# Enumerate computer objects
ADSearch.exe --computers
```
{% endcode %}
{% endtab %}

{% tab title="Groups" %}
Enumerate memberships on the current domain:

```bash
# Enumerate Domain Admins
ADSearch.exe --domain-admins
```

If a bidirectional trust exist, cross-domain enumeration can be perfomed with the use of credentials to avoid the Kerberos Double Hop issue:

{% code overflow="wrap" %}
```bash
# Enumerate Enterprise Admins
ADSearch.exe '--search "(&(objectCategory=group)(cn=enterprise admins))" --attributes cn,member --domain moneycorp.local --username "x7331" --password "P@ss123!"'
```
{% endcode %}
{% endtab %}

{% tab title="OUs" %}
{% code overflow="wrap" %}
```bash
# Enumerate Organizational Units
ADSearch.exe '--search "(objectCategory=organizationalunit)" --attributes name'
```
{% endcode %}
{% endtab %}

{% tab title="GPOs" %}
{% code overflow="wrap" %}
```bash
# Enumerate Group Policy Objects
ADSearch.exe '--search "(objectCategory=groupPolicyContainer)" --attributes displayname'
```
{% endcode %}

To enumerate the GPOs applied to the a specific OU, the `gplink` attribute must first be retrieved. This attribute holds references to GPOs linked to the OU and is not returned by default in a standard LDAP query:

{% code overflow="wrap" %}
```bash
# Enumerate the gplink attribute
ADSearch.exe '--search "(ou=devops)" --attributes gplink'

# List the GPO that corresponds to the target gplink
ADSearch.exe '--search "(&(objectCategory=groupPolicyContainer)(|(name={0BF8D01C-1F62-4BDC-958C-57140B67D147})))" --attributes displayname'
```
{% endcode %}
{% endtab %}
{% endtabs %}
