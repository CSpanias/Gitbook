# BloodHound

{% hint style="info" %}
[Official SpectreOps documentation](https://bloodhound.specterops.io/home).
{% endhint %}

## Ingestors

{% tabs %}
{% tab title="Sharphound" %}


[SharpHound](https://github.com/SpecterOps/SharpHound) is a data collection tool that maps Active Directory environments by gathering information on users, groups, sessions, and permissions, typically used as part of the BloodHound toolset. It does that via Windows API calls and LDAP queries.

{% hint style="warning" %}
**OPSEC**: The `--stealth` option avoids querying Domain Controllers.
{% endhint %}

```powershell
# Collect all available domain information
.\SharpHound.exe -c all
```

Its PowerShell version import [`Sharphound.ps1`](https://github.com/SpecterOps/BloodHound-Legacy/tree/master/Collectors) directly into memory.

{% code overflow="wrap" %}
```powershell
# Execution policy bypass
powershell -ep bypass

# Import module
Import-Module .\Sharphound.ps1

# Collect all available domain information
Invoke-BloodHound -CollectionMethod All -OutputDirectory C:\Users\stephanie\Desktop\ -OutputPrefix "corp audit"
```
{% endcode %}

It collects and compresses domain data (in JSON format) into a `.zip` file. SharpHound may also generate a `.bin` cache file to speed up future runs—this file isn't required for analysis and can be ignored or deleted.&#x20;

SharpHound also supports **looping** for continuous data collection if needed.
{% endtab %}

{% tab title="SOAPHound" %}
[SOAPHound](https://github.com/FalconForceTeam/SOAPHound) talks to AD Web Services (ADWS) on port `9389` instead of LDAP queries (same as AD Module). The ADWS port is open by default. It has almost no network-based detection (e.g. MDI) and it retrieves info about all objects (`objectGuid=*`) and then process them. This means limited LDAP queries - less chance of endpoint detection.

{% code overflow="wrap" %}
```powershell
# Build a cache that includes basic info about domain objects
SOAPHound.exe --buildcache -c c:\ad\tools\cache.txt

# Collect BH compatible data
SOAPHound.exe -c c:\ad\tools\cache.txt --bhdump -o c:\ad\tools\bloodhound-output -nolaps
```
{% endcode %}
{% endtab %}

{% tab title="bloodhound-python" %}
SharpHound's [Python-based version](https://github.com/dirkjanm/BloodHound.py):

{% code overflow="wrap" %}
```bash
# Plaintext creds
bloodhound-python -u <user> -p <password> -dc <FQDN> -c all -d <domain> -ns <dc-ip>

# PtH
bloodhound-python -u <user> --hashes :<NTML> -dc <FQDN> -c all -d <domain> -ns <dc-ip>
```
{% endcode %}
{% endtab %}

{% tab title="nxc" %}
NetExec used `bloodhound-python` under the hood on its [`--bloodhound`](https://www.netexec.wiki/ldap-protocol/bloodhound-ingestor) ingestor:

{% code overflow="wrap" %}
```bash
nxc ldap <dc-ip/FQDN> -u <user> -p <password> --bloodhound -c All --dns-server <dc-ip>
```
{% endcode %}
{% endtab %}
{% endtabs %}



## BloodHound

[BloodHound](https://github.com/SpecterOps/BloodHound) is a graphical tool that visualizes Active Directory relationships and permissions to identify attack paths and privilege escalation opportunities in enterprise environments. Once the data is collected via SharpHound, we can upload the `.zip` file to BloodHound.&#x20;

BloodHound used `neo4j`, a **graph database** that stores data as nodes and relationships—perfect for mapping complex AD environments. The default Neo4j credentials are `neo4j:neo4j`.

{% hint style="success" %}
Custom cypher queries: [BloodHound Queries For All](https://queries.specterops.io/?_gl=1*7tyx8q*_up*MQ..*_ga*NzY0MDQxMzcyLjE3NTAyMjk4OTI.*_ga_53SGLN9EBJ*czE3NTAyMjk4OTAkbzEkZzAkdDE3NTAyMjk4OTAkajYwJGwwJGgw).
{% endhint %}

{% tabs %}
{% tab title="bloodhound-automation" %}
[Bloodhound automation](https://github.com/Tanguy-Boisset/bloodhound-automation) automatically runs and populates a new instance of BH CE:

{% code overflow="wrap" %}
```bash
# Create & start a project
./bloodhound-automation.py start -bp 10001 -np 10501 -wp 8001 my_project

# Import data
./bloodhound-automation.py data -z test.zip my_project

# Delete & clear data
./bloodhound-automation.py delete my_project
./bloodhound-automation.py clear my_project
```
{% endcode %}
{% endtab %}

{% tab title="Manual" %}
```bash
# start the Neo4j service
$ sudo neo4j start
# Launch BloodHound
$ bloodhound
```
{% endtab %}

{% tab title="Docker" %}
```bash
sudo curl -L https://ghst.ly/getbhce | docker compose -f - up
```
{% endtab %}
{% endtabs %}

## AD-miner

[AD Miner](https://github.com/AD-Security/AD_Miner) is an Active Directory auditing tool (supporting both on-prem and Entra ID) that analyzes BloodHound data in a Neo4j database using Cypher queries. It generates a static, web-based report highlighting AD weaknesses with dynamic graphs, risk ratings, historical indicators, and detailed mitigation paths. It requires a Neo4j database populated with AD data from tools like SharpHound, RustHound-CE, BloodHound.py, or AzureHound.&#x20;

For optimal performance, BloodHound Automation is recommended, as it installs the Graph Data Science plugin—enabling faster analysis and smarter pathfinding compared to default BloodHound setups.

{% tabs %}
{% tab title="Basic" %}
Basic usage:

```bash
AD-miner -cf My_Report -u neo4j -p mypassword
```
{% endtab %}

{% tab title="Cache" %}
AD Miner generates cache files after each Neo4j request, allowing the process to be paused or stopped without losing progress (`-c`). Cache files are saved in the `cache_neo4j` folder, and the report name must match the cache file's prefix to reuse cached data:

```bash
AD-miner -c -cf My_Report -u neo4j -p mypassword
```
{% endtab %}
{% endtabs %}

## Resources

* A nice demo of how to use Bloodhound ([video](https://www.youtube.com/watch?v=aJqjH3MsbLM))
