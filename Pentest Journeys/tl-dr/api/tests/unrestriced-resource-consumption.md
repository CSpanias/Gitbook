---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Unrestriced Resource Consumption

> _The below example is based on HTB's_ [_API Attacks_](https://academy.hackthebox.com/course/preview/api-attacks) _module._

**Lack of limiting user-initiated requests** that consume resources such as network bandwidth, CPU, memory, and storage. This can lead to Denial of Service (DoS) attacks (Figure 1) as well as Brute-Force attacks (Figure 2).

<figure><img src="../../../.gitbook/assets/unrestricted_resource_consumption_1.png" alt=""><figcaption><p>Figure 1: A potentlally-vulnerable to Uncontrolled Resource Consumption endpoint.</p></figcaption></figure>

```bash
# Creating a 30 megabytes PDF file
$ dd if=/dev/urandom of=certificateOfIncorporation.pdf bs=1M count=30
30+0 records in
30+0 records out
31457280 bytes (31 MB, 30 MiB) copied, 0.0632942 s, 497 MB/s

$ ls -l
-rw-r--r-- 1 x7331 x7331 31457280 Jul 11 09:18 certificateOfIncorporation.pdf
```

<figure><img src="../../../.gitbook/assets/unrestricted_resource_consumption_2.png" alt=""><figcaption><p>Figure 2: Uploading the PDF file.</p></figcaption></figure>

{% hint style="warning" %}
There are  three main issues here:

1. **The backend does not validate that the file size** is within a specified size and since there are **no rate-limiting measures**, an attacker can consume all the marketplace's disk storage.
2. There is **no check of the file extension or content**, which means we can uploiad any file type we want.
3. **The uploaded files are stored within the `wwwroot` directory**. The web API is developed using ASP.NET Core which means that the static files within `wwwroot` are publicly accessible.
{% endhint %}

<figure><img src="../../../.gitbook/assets/unrestricted_resource_consumption_3.png" alt=""><figcaption><p>Figure 3: Performing a BFA for the user's email due to lack of rate-limiting measures.</p></figcaption></figure>
