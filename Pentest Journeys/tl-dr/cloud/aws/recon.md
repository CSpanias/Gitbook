---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Recon

## Public Cloud <a href="#public-cloud-recon" id="public-cloud-recon"></a>

### **Domain Recon**

Domain reconnaissance is a passive technique used early in an attack to gather intelligence from public data without alerting the target. When starting with just a domain name (e.g., `example.com`), the goal is to uncover DNS infrastructure, hosting details, and associated subdomains. A **recursive approach** is key—every discovered domain, subdomain, or IP can lead to more insights. For instance, querying for name servers can reveal DNS providers like AWS.

> _Every domain is associated with **authoritative name servers**, which are the DNS servers responsible for storing all DNS records, such as `A`, `MX`, and `TXT`, for that domain. Knowing them helps us determine who manages the domain's DNS—often revealing the cloud provider or registrar._

```bash
$ host -t ns example.com
example.com name server ns-1456.awsdns-00.co.uk.
example.com name server ns-533.awsdns-00.net.
```

This assumption can be verified via WHOIS.

> _WHOIS is a protocol used to retrieve registration and ownership information about domain names and IP addresses._

```bash
$ whois ns-1456.awsdns-00.co.uk | grep "Registrant Organization"
Registrant Organization: Amazon Technologies, Inc.
```

To determine where the site is hosted, resolve the domain.

```bash
$ host www.example.com
www.example.com has address 54.73.167.99
```

…then reverse-lookup the IP.

```bash
$ host 54.73.167.99
80.127.74.52.in-addr.arpa domain name pointer ec2-54.73.167.99.compute-1.amazonaws.com
```

…and confirm ownership.

```bash
$ whois 54.73.167.99 | grep "OrgName"
OrgName: Amazon Technologies Inc.
```

This might indicate that the service is hosted on AWS EC2, suggesting the environment could involve AWS-specific services and potential misconfigurations. To discover more subdomains, automated tools like `dnsenum` can brute-force them.

```bash
$ dnsenum example.com --threads 100
-----   example.com   -----

Host's addresses:
example.com.   A   54.73.167.99

Name Servers:
ns-1456.awsdns-00.co.uk.   A   205.251.198.0
...

Trying Zone Transfer for example.com on ns-533.awsdns-00.net ...
AXFR record query failed: corrupt packet
...

Brute forcing with /usr/share/dnsenum/dns.txt:
mail.example.com.   A   54.73.167.99
www.example.com.    A   54.73.167.99
```

Passive recon like this helps build a complete picture of a target's external footprint while avoiding detection.

### Service-Specific Domains <a href="#service-specific-domains" id="service-specific-domains"></a>

Public cloud infrastructure often uses **predictable hostnames that indicate the service in use**, such as `s3.amazonaws.com` for Amazon S3 or `azurewebsites.net` for Azure-hosted apps. Attackers can leverage these naming patterns to identify cloud resources during reconnaissance. For example, a reverse DNS lookup of an IP like `18.102.34.210` might return `ec2-18-102-34-210.compute-1.amazonaws.com`, revealing the use of AWS EC2. This kind of information helps pinpoint the cloud provider and services in use.

Browser developer tools also aid in this recon. By inspecting the Network tab, where each row lists the file name and the domain it originated, we might find that a site loads assets from `s3.amazonaws.com`, with URLs such as:

`https://s3.amazonaws.com/example-assets-public-mnzpytrl/sites/www/images/randomphoto.jpg`

From this, we can infer that the service used is Amazon S3, the **bucket name** is `example-assets-public-mnzpytrl`, and the **object key** is `sites/www/images/randomphoto.jpg` . Visiting the bucket URL without the object path (`https://s3.amazonaws.com/example-assets-public-mnzpytrl/`) may reveal misconfigured permissions such as a directory listing which would indicate public access.

> _In AWS, it’s possible to make individual objects public while keeping the overall bucket private._

The bucket naming conventions often follow patterns like: `[org]-[type]-[env]-[random]`. If the naming is predictable, attackers can guess related buckets (e.g., `example-assets-private-mnzpytrl`). Response types (`AccessDenied`, `NoSuchBucket`) help confirm their existence and security posture.&#x20;

> _Because S3 bucket names must be globally unique, teams often append a random or hashed suffix to prevent naming collisions. This also serves as a mild deterrent against enumeration. However, if multiple buckets use the same suffix, an attacker can guess them more easily._

To scale this, we can use tools like  [`cloud_enum`](https://github.com/initstring/cloud_enum), which searches for cloud assets across AWS, Azure, and GCP using keyword-based guessing.

```bash
cloud_enum -k example-assets-public-mnzpytrl -qs --disable-azure --disable-gcp
```

Or generate variations with:

```bash
$ for key in "public" "private" "dev" "prod"; do
    echo "example-assets-$key-mnzpytrl"
done | tee /tmp/keyfile.txt

$ cloud_enum -kf /tmp/keyfile.txt -qs --disable-azure --disable-gcp
```

This approach helps identify misconfigured or exposed buckets across cloud providers efficiently.

## CSP API Recon

### Cloud APIs

