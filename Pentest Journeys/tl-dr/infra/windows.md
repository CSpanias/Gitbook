---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Windows

{% hint style="warning" %}
Run [`winPEAS`](https://github.com/peass-ng/PEASS-ng/tree/master/winPEAS) for automated host enumeration!
{% endhint %}

## Get Help

{% tabs %}
{% tab title="CMD" %}
```sh
# List available commands
help

# Help for a specified command
help <command>
<command> /?
```
{% endtab %}

{% tab title="PS" %}
```powershell
# List available commands
Get-Command

# Help for a specified command
Get-Help <command>
<command> -?
```
{% endtab %}
{% endtabs %}

## Networking

> _All the below commands work with both CMD and Powershell._

{% tabs %}
{% tab title="Network Info" %}
General networking information, such as interfaces, IP addresses, and DNS:

```sh
ipconfig /all
```
{% endtab %}

{% tab title="ARP Table" %}
Check recent communications via the ARP table:

```sh
arp -a
```
{% endtab %}

{% tab title="Active Connections" %}
List active TCP and UDP connections:

```sh
netstat -ano
```
{% endtab %}

{% tab title="Routes" %}
List recent and persistent routes:

```sh
route print
```
{% endtab %}
{% endtabs %}

## System

{% tabs %}
{% tab title="PS" %}
General enumeration:

{% code overflow="wrap" %}
```powershell
# General system information
systeminfo

# Name of the host
hostname

# Operating system version
[environment]::OSVersion.Version

# PowerShell history file
Get-Content C:\Users\legacyy\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt

# Environment variables
dir env:

# Named pipes
gci \\.\pipe\
```
{% endcode %}

Applications:

```powershell
# Installed applications
Get-WmiObject -Class Win32_Product |  select Name, Version
wmic product get name
```

Processes:

```powershell
# List running processes
tasklist
# Information about a specific process
Get-Process -Id <PID>
tasklist /FI "PID eq <PID>"
```

Services:

```powershell
# Services hosted in each process
tasklist /svc
```

Other:

```powershell
```
{% endtab %}

{% tab title="CMD" %}
General enumeration:

```sh
# General system information
systeminfo

# Hostname
hostname

# Operating system version
ver
echo %OS%

# List environment variables
set

# Diplay the value of a specific variable
set %PATH%
echo %PATH%
```

Applications:

```sh
# Installed applications
wmic product get name
```

Processes:

```shell
# Running process
tasklist

# Information about a specific process
tasklist /FI "PID eq <PID>"
```

Services:

```sh
# Running services
tasklist /svc
net start
wmic service list brief # deprecated

# Manage a service
net <start | stop | pause | continue> <service>

# Query running services
sc query type= service

# Start / stop a service
sc <start | stop> <service>

# Modify start type (service won't be able to start with 'sc start <service>'
sc config <service> start= disabled

# Revert the change
sc config <service> start= auto
```

Other:

```sh
# Login server for the current user followed by the machine's hostname
echo %LOGONSERVER%

# The location of the current user's home directory
echo %USERPROFILE%
```
{% endtab %}
{% endtabs %}

## Users & Groups

> _All the below commands work with both CMD and Powershell._

{% tabs %}
{% tab title="Users" %}
{% code overflow="wrap" %}
```sh
# Domain/username (domain-joined) or NetBIOS/username (non domain-joined)
whoami

# List current user's privileges
whoami /priv

# List current user's information
whoami /all

# List local users
net user

# List active (logged-on) users (works only on Windows Servers)
query user
```
{% endcode %}
{% endtab %}

{% tab title="Groups" %}
```sh
# List current user's groups
whoami /groups

# List local groups
net localgroup

# List domain groups (works only on a DC)
net group

# List group members
net localgroup <group>
```
{% endtab %}
{% endtabs %}

## Shared Resources

> _All the below commands work with both CMD and Powershell._

```powershell
# List resources
net share
```

## Protections

{% tabs %}
{% tab title="Windows Defender" %}
Check WD's status with PS:

```powershell
Get-MpComputerStatus
```

Check WD's status with CMD:

```sh
sc query windefend
```
{% endtab %}

{% tab title="AppLocker" %}
Check AppLocker's rules and policies with PS:

{% code overflow="wrap" %}
```powershell
# AppLocker rules
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections

# AppLocker policy
Get-AppLockerPolicy -Local | Test-AppLockerPolicy -path C:\Windows\System32\cmd.exe -User Everyone
```
{% endcode %}
{% endtab %}

{% tab title="HotFixes" %}
List hotfixes with both CMD and PS:

```powershell
wmic qfe
```
{% endtab %}
{% endtabs %}

## Files

{% tabs %}
{% tab title="PowerShell" %}
{% code overflow="wrap" %}
```powershell
# List all (including) hidden files
Get-ChildItem -Force

# Search for a specific file
Get-ChildItem -Path C:\ -Filter local.txt -Recurse -ErrorAction SilentlyContinue -Force
```
{% endcode %}
{% endtab %}

{% tab title="CMD" %}
{% code overflow="wrap" %}
```sh
# List all (including) hidden files
dir /a

# Search for a specific file
dir C:\local.txt /s /a
dir C:\ /s /a /b | findstr /i "local.txt"
```
{% endcode %}
{% endtab %}
{% endtabs %}

