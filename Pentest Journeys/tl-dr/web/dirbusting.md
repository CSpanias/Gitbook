---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Dirbusting

## 101

### Fuzzing vs Dirbusting

**Fuzzing** is a broad testing method where <mark style="background-color:yellow;">many random or crafted inputs are sent to an application to find bugs or vulnerabilities</mark>.&#x20;

**Directory busting** is a technique used to <mark style="background-color:yellow;">find hidden or unlinked directories and files</mark> on a web server by systematically guessing or trying many possible names. Directory busting is **a specific type of fuzzing** focused on uncovering directories and files on a server.

### Subdomain vs Vhost

A **subdomain** is like <mark style="background-color:yellow;">an extension of your main website address</mark>. For example, if your main website is `example.com`, a subdomain could be `blog.example.com` or `shop.example.com`. It’s part of the internet’s addressing system called DNS, which works like a phonebook that tells computers where to find websites. Creating a subdomain lets you organize different parts of your website or even run separate sites under the same main domain name.

A **Virtual Host (vhost)** is a <mark style="background-color:yellow;">set of instructions on a web server</mark> that tells it how to handle requests for different domain names or subdomains. Imagine a web server as a building that hosts many websites at once. The virtual host settings act like room assignments, so when someone visits `blog.example.com`, the server knows exactly which website files to show for that address. This way, one server can manage many websites or subdomains without mixing them up.

**Subdomains and vhosts work together**: the former points users to your server, and the latter tells the server what to do with those requests.

## .DS\_Store

The `.DS_Store` file is a <mark style="background-color:yellow;">hidden metadata file</mark> that macOS automatically creates in every folder opened in Finder. It stores visual settings like icon layout, view preferences, and other folder display details.

While it's harmless and meaningless to the server itself (like IIS on Windows), it can <mark style="background-color:yellow;">leak valuable information</mark>. If a `.DS_Store` file is publicly accessible on a web server, it may contain <mark style="background-color:yellow;">**references to files or subdirectories**</mark> that aren’t directly linked or visible in the browser.

Using tools like [**`ds_walk.py`**](https://github.com/Keramas/DS_Walk) can extract and reconstruct the folder structure that the `.DS_Store` file references.

```bash
./ds_walk.py -u http://compatibility
```

## Tools

{% tabs %}
{% tab title="fuff" %}
[ffuf](https://github.com/ffuf/ffuf) is a fast web fuzzer written in Go.

Directories:

{% code overflow="wrap" %}
```bash
ffuf -u http://example.com/FUZZ -w /usr/share/seclists/Discovery/Web-Content/directory-list-2.3-medium.txt -ac -c -ic -recursion -recursion-depth 3
```
{% endcode %}

Files:

{% code overflow="wrap" %}
```bash
ffuf -u http://<target>/FUZZ -w /usr/share/seclists/Discovery/Web-Content/raft-medium-files.txt -ic -c -ac -e .php,.txt,.aspx
```
{% endcode %}

Subdomains:

{% code overflow="wrap" %}
```bash
ffuf -u http://FUZZ.example.com -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -ac -c -ic
```
{% endcode %}

Vhosts:

{% code overflow="wrap" %}
```bash
ffuf -u http://site.com -w /usr/share/seclists/Discovery/DNS/namelist.txt -H "HOST: FUZZ.site.com" -ac -c -ic
```
{% endcode %}

Parameters:

{% code overflow="wrap" %}
```bash
ffuf -u https://streamio.htb/admin/?FUZZ=* -w /usr/share/seclists/Discovery/Web-Content/burp-parameter-names.txt -ic -c -ac -k -H 'Cookie: PHPSESSID=l5l8ad3k06f2h9493eqgtn9ppb'
```
{% endcode %}

POST parameters:

{% code overflow="wrap" %}
```bash
ffuf -w <WORDLIST> -u <URL> -X POST -H 'Content-Type: application/json' -d '{"uid":"FUZZ"}'
```
{% endcode %}
{% endtab %}

{% tab title="gobuster" %}
[gobuster](https://github.com/OJ/gobuster) is a brute-forcing tool written in GO.



Directories:

{% code overflow="wrap" %}
```bash
gobuster dir -u http://site.com -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt
```
{% endcode %}

Files:

{% code overflow="wrap" %}
```bash
gobuster dir -u http://site.com -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x .aspx,.html,.php,.txt,.jsp
```
{% endcode %}

Subdomains:

{% code overflow="wrap" %}
```bash
gobuster dns -d site.com -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt -i

# Local DNS
gobuster dns -d site.com -w /usr/share/wordlists/seclists/Discovery/DNS/subdomains-top1million-20000.txt -r 10.10.10.10:53 -i
```
{% endcode %}

Vhosts:

{% code overflow="wrap" %}
```bash
gobuster vhost -u http://10.10.10.10 -w /usr/share/seclists/Discovery/DNS/subdomains-top1million-20000.txt --append-domain
```
{% endcode %}
{% endtab %}

{% tab title="dirsearch" %}
[dirsearch](https://github.com/maurosoria/dirsearch) is a web path brute-forcer tool.

Directories:

```bash
dirsearch -u http://172.16.10.10:8081/
```
{% endtab %}
{% endtabs %}
