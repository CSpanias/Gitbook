---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# SQLi

{% hint style="info" %}
SQL injection (SQLi) is a vulnerability where an attacker can manipulate a web application's database queries by injecting malicious SQL code through user inputs.
{% endhint %}

{% hint style="danger" %}
This can lead to unauthorized data access, data corruption, deletion of data, and potentially complete control over the database server.
{% endhint %}

{% hint style="success" %}
Use prepared statements and parameterized queries, validate and sanitize user inputs, and employ ORM (Object-Relational Mapping) frameworks to abstract database operations.
{% endhint %}

## Educated Guesses

If we know the web server, we might infer what database in in use.

<table><thead><tr><th width="166">Web Server</th><th width="145">Database</th><th>Db-specific SQLi</th></tr></thead><tbody><tr><td>IIS </td><td>MSSQL</td><td>For <strong>MSSQL-specific</strong> SQLi info see <a href="../../../../services/sql/mssql-1433.md#sqli">here</a>. </td></tr><tr><td>Apache/Nginx</td><td>MySQL </td><td>For <strong>MySQL-specific</strong> SQLi info see <a href="../../../../services/sql/mysql-3306.md#sqli">here</a>.</td></tr></tbody></table>

## SQLi Types

> _Alex Olsen's Blind SQLi_ [_payload examples_](https://www.db-fiddle.com/f/nLpyQDMd49iRygnY9H7CB8/5).

<div align="center">

<figure><img src="../../../../.gitbook/assets/sqli_types.png" alt="" width="563"><figcaption><p>Figure 1: SQL Injection types (<em>imaged adapted from</em> <a href="https://www.qafox.com/sql-injection-types/"><em>here</em></a>).</p></figcaption></figure>

</div>

## Discovery

We can enumerate SQLi flaws via:

1. Sending **manual** payloads.
2. Searching for dynamic SQL statements during a **code review**.
3. **Fuzzing** the request.

## Detection

| Payload | URL Encoded |
| ------- | ----------- |
| `'`     | `%27`       |
| `"`     | `%22`       |
| `#`     | `%23`       |
| `;`     | `%3B`       |
| `)`     | `%29`       |

We can also fuzz for pontially banned characters.

{% code overflow="wrap" %}
```bash
ffuf -k -u https://watch.streamio.htb/search.php -d 'q=FUZZ' -w /usr/share/seclists/Fuzzing/special-chars.txt -c -ic -ac -H 'Content-Type: application/x-www-form-urlencoded'
```
{% endcode %}
