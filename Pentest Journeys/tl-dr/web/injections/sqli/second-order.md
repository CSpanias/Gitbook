---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Second Order

{% hint style="success" %}
A **second-order SQLi** is an attack where the malicious SQL code is **stored in the database during the initial interaction** and then **executed later** when the stored data is used in another SQL query.
{% endhint %}

> _The example below is based on TCM's_ [_Practical Bug Bounty_](https://academy.tcm-sec.com/p/practical-bug-bounty) _course._

The application has a `Sign Up` and a `Login` functionality (Figure 1).

<figure><img src="../../../../.gitbook/assets/web_sqli_secondOrder_1.png" alt="" width="563"><figcaption><p>Figure 1: The web application's homepage.</p></figcaption></figure>

If we go step through the functionality as intented, i.e., registering a user and then logging in with that user, we will notice that the username gets reflected in the dashboard (Figure 2).&#x20;

<figure><img src="../../../../.gitbook/assets/web_sqli_secondOrder_2.png" alt=""><figcaption><p>Figure 2: Stepping through the <code>Sign Up</code> and <code>Login</code> flows.</p></figcaption></figure>

We can try registering using a common SQLi payload instead of a normal username and check if this has any effect when we log in (Figure 3).

<figure><img src="../../../../.gitbook/assets/web_sqli_secondOrder_3.png" alt=""><figcaption><p>Figure 3: Achieving a second order SQLi.</p></figcaption></figure>
