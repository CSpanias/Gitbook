---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Stored

{% hint style="success" %}
**Stored XSS** is a type of Cross-Site Scripting where the malicious script is stored on the target server, such as in a database, and then displayed on web pages viewed by users. This makes it more persistent and can affect multiple users who visit the infected page.
{% endhint %}

## Basic

> _The example below is based on TCM's_ [_Practical Bug Bounty_](https://academy.tcm-sec.com/p/practical-bug-bounty) _course._

This application just allows to post comments. We can start by checking if the target is vulnerable to HTML injection before testing straight for XSS (Figure 1).

<figure><img src="../../../../.gitbook/assets/web_xss_stored_basic_1.png" alt=""><figcaption><p>Figure 1: Testing for HTML injection.</p></figcaption></figure>

Next, we want to test for Stored XSS. The easiest way to do this is by using [Firefox's Multi-Account Containers extension](../../authorization/automated-a-b-testing.md#multi-account-containers), create an XSS payload with `UserA`, and then visit the page with `UserB` to see if the payload is executed (Figure 2).

<figure><img src="../../../../.gitbook/assets/web_xss_stored_basic_2.png" alt=""><figcaption><p>Figure 2: Using FireFox's containers to test for Stored XSS.</p></figcaption></figure>

## href Attribute

> The example below is based on PortSwigger's [_Stored XSS into anchor `href` attribute with double quotes HTML-encoded_](https://portswigger.net/web-security/cross-site-scripting/contexts/lab-href-attribute-double-quotes-html-encoded) lab.

In this application there is a comment functionality which also includes a `Website` field. The value of this field is stored within the HTML `href` attribute (Figure 1).

<figure><img src="../../../../.gitbook/assets/web_xss_stored_1.png" alt=""><figcaption><p>Figure 1: Identifying potential XSS vectors.</p></figcaption></figure>

We can try escaping the tag with payloads such as :

```javascript
"><script>alert()</script>
"><img src=x onerror=alert()>
```

Unfortunately, neither of the above payloads work. However, the `href` attribute can itself create a scriptable context, thus, we are not required to escape it. In this case, we can use the `javascript` pseudo-protocol directly (Figure 2).

```javascript
javascript:alert()
```

<figure><img src="../../../../.gitbook/assets/web_xss_stored_2.png" alt="" width="544"><figcaption><p>Figure 2: Achieving Stored XSS via a URI-scheme based payload.</p></figcaption></figure>
