---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Race Conditions

{% hint style="success" %}
A **race condition** vulnerability occurs when the outcome of a process depends on the timing or sequence of events, allowing attackers to manipulate the process to achieve unintended or unauthorized results. This can lead to data corruption, unauthorized access, or other security issues.
{% endhint %}

## Examples

### Limit Overrun

{% hint style="success" %}
One-time use actions, such as redeeming a coupon, rating a product, or withdrawing money. The exploitation process is the following:

1. Find a single-use endpoint
2. Send multiple requests to see if the limit can be overrun
{% endhint %}

> _The example below is based on PostSwigger's_ [_Limit overrun race conditions_](https://portswigger.net/web-security/race-conditions/lab-race-conditions-limit-overrun) _lab._

The application has a field for inserting a coupon at checkout as well as current coupon that gives us 20% off (Figure 1).

<figure><img src="../../.gitbook/assets/web_race_cond.png" alt=""><figcaption><p>Figure 1: The application's coupon functionality.</p></figcaption></figure>

The server prevents coupon abuse, i.e., the same coupon being applied multiple times, when sending the requests sequentially (Figure 2).

<figure><img src="../../.gitbook/assets/web_race_cond_1.png" alt=""><figcaption><p>Figure 2: The application prevents coupon reuse.</p></figcaption></figure>

We can try testing for a race condition vulnerability by replicating the same request multiple times and sending all simultaneously (Figure 3).

<figure><img src="../../.gitbook/assets/web_race_cond_2.png" alt=""><figcaption><p>Figure 3: Leveraging Burp's features to exploit a race conditiong vulnerability.</p></figcaption></figure>

### Single Endpoint

{% hint style="success" %}
asd
{% endhint %}

> _The example below is based on PostSwigger's_ [_Single-endpoint race conditions_](https://portswigger.net/web-security/race-conditions/lab-race-conditions-single-endpoint) _lab._

### Multi-Endpoint

{% hint style="success" %}
asd
{% endhint %}

> _The example below is based on PostSwigger's_ [_Multi-endpoint race conditions_](https://portswigger.net/web-security/race-conditions/lab-race-conditions-multi-endpoint) _lab._
