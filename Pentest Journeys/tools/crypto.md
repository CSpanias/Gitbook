# Cryptography

## Ciphers

{% hint style="success" %}
[Cipher Identifier & Analyzer](https://www.boxentriq.com/code-breaking/cipher-identifier)
{% endhint %}

{% tabs %}
{% tab title="ROT13" %}
Online [ROT13 encoder](https://rot13.com/).

```bash
# Alias
alias rot13="tr 'A-Za-z' 'N-ZA-Mn-za-m'"

# Encrypt
echo '<plaintext>' | tr 'A-Za-z' 'N-ZA-Mn-za-m'

# Decrypt
echo '<ciphertext>' | tr 'N-ZA-Mn-za-m' 'A-Za-z'
```
{% endtab %}

{% tab title="ROT13.5" %}
The ROT13.5 cipher is: ROT13 for letters and ROT5 for numbers.

```bash
# Encrypt
echo '<plaintext>' | tr 'A-Za-z0-9' 'N-ZA-Mn-za-m5-90-4'

# Decrypt
echo '<ciphertext>' | tr 'N-ZA-Mn-za-m5-90-4' 'A-Za-z0-9'
```
{% endtab %}

{% tab title="ROT47" %}
```bash
# Encrypt
echo '<plaintext>' | tr '\!-~' 'P-~\!-O'

# Decrypt
echo '<ciphertext>' | tr 'P-~\!-O' '\!-~'
```
{% endtab %}

{% tab title="Caesar" %}
```bash
# Encrypt
echo '<plaintext>' | tr '[a-zA-Z]' '[x-za-wX-ZA-W]'

# Decrypt
echo '<ciphertext>' | tr '[x-za-wX-ZA-W]' '[a-zA-Z]'
```
{% endtab %}

{% tab title="ROT Script" %}
```bash
# ROT script
#!/usr/bin/bash
    
dual=abcdefghijklmnopqrstuvwxyzabcdefghijklmnopqrstuvwxyz
phrase='<plaitext>'
rotat=13
newphrase=$(echo $phrase | tr "${dual:0:26}" "${dual:${rotat}:26}")
echo ${newphrase}
```
{% endtab %}

{% tab title="Vigenere" %}
Use `vigenere.sh -d` to decrypt.

```bash
# Vigenere script
#!/usr/local/bin/bash

a="ABCDEFGHIJKLMNOPQRSTUVWXYZ"

[[ "${*/-d/}" != "" ]] &&
echo "Usage: $0 [-d]" && exit 1
m=${1:+-}

printf "string: ";read t
printf "keyphrase: ";read -s k
printf "\n"
for ((i=0;i<${#t};i++)); do
  p1=${a%%${t:$i:1}*}
  p2=${a%%${k:$((i%${#k})):1}*}
  d="${d}${a:$(((${#p1}${m:-+}${#p2})%${#a})):1}"
done
echo "$d"
```
{% endtab %}
{% endtabs %}

## Encoders

{% tabs %}
{% tab title="Base64" %}
```bash
# Encode
base64 <TEXT>

# Decode
base64 -d <TEXT>
```
{% endtab %}

{% tab title="URL" %}
[Urlencoder](https://www.urlencoder.org/) | [Urldecoder](https://www.urldecoder.org/)

{% code overflow="wrap" %}
```bash
# Encode
echo "cat flag.txt" | jq -sRr @uri
hURL -U "cat flag.txt"

# Decode
echo "<urlEncodedString" | python3 -c 'import sys;from urllib.parse import unquote;print(unquote(sys.stdin.read()));'
```
{% endcode %}
{% endtab %}

{% tab title="Hex" %}
```bash
# Encode
echo <text> | xxd -p

# Decode
echo <text> | xxd -p -r
```
{% endtab %}
{% endtabs %}

## Hashes

{% tabs %}
{% tab title="MD5" %}
```bash
md5sum <TEXT>
openssl md5 <TEXT>
```
{% endtab %}

{% tab title="SHA256" %}
```bash
sha256sum <TEXT>
openssl sha256 <TEXT>
```
{% endtab %}

{% tab title="SHA1" %}
```bash
sha1sum <TEXT>
openssl sha1 <TEXT>
```
{% endtab %}
{% endtabs %}
