---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Manual Host Recon

## CMD

### Help

```powershell
# List available commands
help
# Help for a specified command
help <COMMAND>
# Or
<COMMAND> /?
```

### Networking

All commands work with both CMD and Powershell.

{% tabs %}
{% tab title="Network Info" %}
General networking information, such as interfaces, IP addresses, and DNS:

```sh
ipconfig /all
```
{% endtab %}

{% tab title="ARP Table" %}
Check recent communications via the ARP table:

```sh
arp -a
```
{% endtab %}

{% tab title="Active Connections" %}
List active TCP and UDP connections:

```sh
netstat -ano
```
{% endtab %}

{% tab title="Routes" %}
List recent and persistent routes:

```sh
route print
```
{% endtab %}
{% endtabs %}

### System

{% tabs %}
{% tab title="General" %}
```sh
# General system information
systeminfo
# Hostname
hostname
# Operating system version
ver
echo %OS%
# List environment variables
set
# Diplay the value of a specific variable
set %PATH%
echo %PATH%
```
{% endtab %}

{% tab title="Apps" %}
```sh
# Installed applications
wmic product get name
```
{% endtab %}

{% tab title="Processes" %}
```sh
# Running process
tasklist
# Information about a specific process
tasklist /FI "PID eq <PID>"
```
{% endtab %}

{% tab title="Services" %}
```sh
# Running services
tasklist /svc
net start
wmic service list brief # deprecated
# Manage a service
net <start | stop | pause | continue> <service>
# Query running services
sc query type= service
# Start / stop a service
sc <start | stop> <service>
# Modify start type (service won't be able to start with 'sc start <service>'
sc config <service> start= disabled
# Revert the change
sc config <service> start= auto
```
{% endtab %}

{% tab title="Other" %}
```sh
# Login server for the current user followed by the machine's hostname
echo %LOGONSERVER%
# The location of the current user's home directory
echo %USERPROFILE%
```
{% endtab %}
{% endtabs %}

### Users & Groups

{% tabs %}
{% tab title="Users" %}
{% code overflow="wrap" %}
```sh
# Domain/username (domain-joined) or NetBIOS/username (non domain-joined)
whoami
# List current user's privileges
whoami /priv
# List current user's information
whoami /all
# List local users
net user
# List active (logged-on) users (works only on Windows Servers)
query user
```
{% endcode %}
{% endtab %}

{% tab title="Groups" %}
```sh
# List current user's groups
whoami /groups
# List local groups
net localgroup
# List domain groups (works only on a DC)
net group
# List group members
net localgroup <group>
```
{% endtab %}
{% endtabs %}

### Shared Resources

```powershell
# List resources
net share
```

### Protections

{% tabs %}
{% tab title="Windows Defender" %}
```sh
# Query Windows Defender' status
sc query windefend
```
{% endtab %}

{% tab title="HotFixes" %}
```sh
wmic qfe
```
{% endtab %}
{% endtabs %}

## PowerShell

### Networking

[Same](manual-host-recon.md#cmd) as CMD.

### System

{% tabs %}
{% tab title="General" %}
{% code overflow="wrap" %}
```powershell
# General system information
systeminfo
# Name of the host
hostname
# Operating system version
[environment]::OSVersion.Version
# PowerShell history file
Get-Content C:\Users\legacyy\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
# Environment variables
dir env:
# Named pipes
gci \\.\pipe\
```
{% endcode %}
{% endtab %}

{% tab title="Apps" %}
```powershell
# Installed applications
Get-WmiObject -Class Win32_Product |  select Name, Version
wmic product get name
```
{% endtab %}

{% tab title="Processes" %}
```powershell
# List running processes
tasklist
# Services hosted in each process
tasklist /svc
# Information about a specific process
Get-Process -Id <PID>
tasklist /FI "PID eq <PID>"
```
{% endtab %}
{% endtabs %}

### Users & Groups

[Same](manual-host-recon.md#users-and-groups) as CMD.

### Shared Resources

[Same](manual-host-recon.md#shared-resources) as CMD.

### Protections

{% tabs %}
{% tab title="Windows Defender" %}
Check WD's status:

```powershell
Get-MpComputerStatus
```
{% endtab %}

{% tab title="AppLocker" %}
{% code overflow="wrap" %}
```powershell
# AppLocker rules
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
# AppLocker policy
Get-AppLockerPolicy -Local | Test-AppLockerPolicy -path C:\Windows\System32\cmd.exe -User Everyone
```
{% endcode %}
{% endtab %}

{% tab title="HotFixes" %}
List hotfixes:

```powershell
wmic qfe
```
{% endtab %}
{% endtabs %}

### Files

{% code overflow="wrap" %}
```powershell
# List all (including) hidden files
Get-ChildItem -Force
# Search for a specific file
Get-ChildItem -Path C:\ -Filter local.txt -Recurse -ErrorAction SilentlyContinue -Force
```
{% endcode %}

## Linux

