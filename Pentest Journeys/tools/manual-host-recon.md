---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Manual Host Recon

## CMD

### Help

```powershell
# List available commands
help
# Help for a specified command
help <COMMAND>
# Or
<COMMAND> /?
```

### Networking

All commands work with both CMD and Powershell.

```powershell
# General networking information, such as interfaces, IP addresses, and DNS
ipconfig /all
# Check recent communications via the ARP table
arp -a
# Active TCP and UDP connections
netstat -ano
# Recent and persistent routes
route print
```

### System

```powershell
# Name of the host
hostname
# Operating system version
ver
echo %OS%
# General system information
systeminfo
# Running process
tasklist
# Running services
tasklist /svc
net start
wmic service list brief # deprecated
# Manage a service
net <start | stop | pause | continue> <service>
# Information about a specific process
tasklist /FI "PID eq <PID>"
# Environment variables
set
# Diplay the value of a specific variable
set %PATH%
echo %PATH%
# Login server for the current user followed by the machine's hostname
echo %LOGONSERVER%
# The location of the current user's home directory
echo %USERPROFILE%
# Installed applications
wmic product get name
```

```powershell
# Query running services
sc query type= service
# Start / stop a service
sc <start | stop> <service>
# Modify start type (service won't be able to start with 'sc start <service>'
sc config <service> start= disabled
# Revert the change
sc config <service> start= auto
```

### Users & Groups

```powershell
# Domain/username or NetBIOS/username, if the host is or isn't domain-joined, respectively
whoami
# List current user's privileges
whoami /priv
# List current user's groups
whoami /groups
# List current user's information
whoami /all
# List local users
net user
# List local groups
net localgroup
# List domain groups (works only on a DC)
net group
# List group members
net localgroup <group>
# List active (logged-on) users (works only on Windows Servers)
query user
```

### Shared Resources

```powershell
# List resources
net share
```

### Protections

```powershell
# Query Windows Defender
sc query windefend
# Hotfixes
wmic qfe
```

## PowerShell

#### Networking

[Same](manual-host-recon.md#cmd) as CMD.

#### System

{% code overflow="wrap" %}
```powershell
# Name of the host
hostname
# General system information
systeminfo
# Operating system version
[environment]::OSVersion.Version
# PowerShell history file
Get-Content C:\Users\legacyy\AppData\Roaming\Microsoft\Windows\PowerShell\PSReadLine\ConsoleHost_history.txt
# Running process
tasklist
# Services hosted in each process
tasklist /svc
# Information about a specific process
Get-Process -Id <PID>
tasklist /FI "PID eq <PID>"
# Environment variables
dir env:
# Installed applications
Get-WmiObject -Class Win32_Product |  select Name, Version
wmic product get name
# Named pipes
gci \\.\pipe\
```
{% endcode %}

#### Users & Groups

{% code overflow="wrap" %}
```powershell
# Domain/username or NetBIOS/username, if the host is or isn't domain-joined, respectively
whoami
# List current user's privileges
whoami /priv
# List current user's groups
whoami /groups
# List current user's information
whoami /all
# List host's users
net user
# List local groups
net localgroup
# List domain groups (works only on a DC)
net group
# List group members
net localgroup <group>
# List active (logged-on) users (works only on Windows Servers)
query user
```
{% endcode %}

#### Shared Resources

```powershell
# List resources
net share
```

#### Protections

{% code overflow="wrap" %}
```powershell
# Windows Defender status
Get-MpComputerStatus
# AppLocker rules
Get-AppLockerPolicy -Effective | select -ExpandProperty RuleCollections
# AppLocker policy
Get-AppLockerPolicy -Local | Test-AppLockerPolicy -path C:\Windows\System32\cmd.exe -User Everyone
# Hotfixes
wmic qfe
```
{% endcode %}

Files

{% code overflow="wrap" %}
```powershell
# List all (including) hidden files
> Get-ChildItem -Force

# Search for a specific file
Get-ChildItem -Path C:\ -Filter local.txt -Recurse -ErrorAction SilentlyContinue -Force
```
{% endcode %}

## Linux

