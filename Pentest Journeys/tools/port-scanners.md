---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Port Scanners

{% tabs %}
{% tab title="nmap" %}
[**Nmap**](https://nmap.org/) is a powerful network scanning tool used to discover hosts, services, and vulnerabilities on a network.

Host discovery:

```bash
# Ping sweep (no port scanning)
sudo nmap -sn 172.16.10.0/24

# Extract IPs
sudo nmap -sn 172.16.10.0/24 | grep 'report' | awk '{print $NF}'
```

Banner grabbing:

{% code overflow="wrap" %}
```bash
nmap -sV --script=banner.nse -iL live_hosts | grep "|_banner\||_http-server-header"
```
{% endcode %}

Exclude IPs:

```bash
sudo nmap -iL live_hosts -A --open --exclude 172.16.10.1
```
{% endtab %}

{% tab title="rustscan" %}
[**RustScan**](https://github.com/bee-san/RustScan) is a fast port scanner built in Rust that quickly identifies open ports and hands them off to tools like Nmap for detailed analysis.

{% code overflow="wrap" %}
```bash
# IP address
rustscan -a <IP>

# With a target file and extract IPs (greppable)
rustscan -a "$(cat live_hosts | tr '\n' ',')" -g | awk -F'->' '{print $1,$2}' | tr -d '[]'

# With a target file and extract IPs (default)
rustscan -a "$(cat live_hosts | tr '\n' ',')"
```
{% endcode %}

Combining `rustscan` and `nmap` flags:

```bash
rustscan -a 127.0.0.1 -- -A -sC
```

Open ports with `rustscan` -> `nmap`:

{% code overflow="wrap" %}
```bash
# Finding open ports
rustscan -a 10.10.11.152 -g --ulimit=5000

# Querying services details
nmap -T4 -min-rate 100000 10.10.11.152 -sV -sC -p $(cat open_ports | awk -F'>' '{print $2}' | tr -d '[]') -Pn
```
{% endcode %}
{% endtab %}

{% tab title="arp-scan" %}
[**arp-scan**](https://github.com/royhills/arp-scan) is a tool that scans a local network by sending ARP requests to identify all active devices and their MAC addresses. It requires elevated privileges (`sudo`).&#x20;

{% hint style="info" %}
The output consists of the IP address, the MAC address, and the vendor details (identified by the first 3 octes of the MAC address).
{% endhint %}

```bash
# Basic usage
sudo arp-scan 172.16.10.0/24 -I br_public

# With a target file
sudo arp-scan -f live_hosts -I br_public

# Plain output & IPs addresses
sudo arp-scan 172.16.10.0/24 -x -I br_public | awk '{print $1}'

# Default output & IPs addresses
sudo arp-scan 172.16.10.0/24 -I br_public | awk 'NR > 2 && NR <7 {print $1}'
```
{% endtab %}

{% tab title="nc" %}
[Netcat](https://linux.die.net/man/1/nc) is a versatile networking utility used for reading from and writing to network connections, often called the “Swiss-army knife” of networking.

```bash
# TCP scan on zero I/O mode (don't send any data (-z))
nc -zv 172.16.10.11 1-1024
```
{% endtab %}

{% tab title="PS" %}
Ping sweep with PowerShell:

{% code overflow="wrap" %}
```powershell
1..100 | % {"172.16.9.$($_): $(Test-Connection -count 1 -comp 172.16.9.$($_) -quiet)"}
```
{% endcode %}
{% endtab %}
{% endtabs %}
