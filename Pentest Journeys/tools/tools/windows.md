---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Windows

## Whitelisted and writable directories.

{% tabs %}
{% tab title="1. Dirs" %}
{% code overflow="wrap" %}
```powershell
C:\Windows\System32\spool\drivers\color
C:\Windows\Tasks
C:\Users\Public
C:\Windows\Temp
C:\Users\<user>\AppData\Local\Temp
C:\windows\tracing
C:\Windows\Registration\CRMLog
C:\Windows\System32\FxsTmp
C:\Windows\System32\com\dmp
C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys
C:\Windows\System32\spool\PRINTERS
C:\Windows\System32\spool\SERVERS
C:\Windows\System32\Tasks\Microsoft\Windows\SyncCenter
C:\Windows\System32\Tasks_Migrated
C:\Windows\SysWOW64\FxsTmp
C:\Windows\SysWOW64\com\dmp
C:\Windows\SysWOW64\Tasks\Microsoft\Windows\SyncCenter
C:\Windows\SysWOW64\Tasks\Microsoft\Windows\PLA\System
```
{% endcode %}
{% endtab %}

{% tab title="2. Test" %}
```powershell
# create a file
echo test > test
# delete the file
del test
```
{% endtab %}
{% endtabs %}

## Use another user's credentials

{% code overflow="wrap" %}
```powershell
$user_pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force
$user_creds = New-Object System.Management.Automation.PSCredential('<DOMAIN\user', $user_pass)
# adding a member to a group
Add-DomainGroupMember -Identity '<GROUP>' -Members '<USER>' -Credential $user_creds -verbose
```
{% endcode %}

## System Information

### [Get-WmiObject](https://learn.microsoft.com/en-us/powershell/module/microsoft.powershell.management/get-wmiobject?view=powershell-5.1)

To specify a remote computer, use the `-ComputerName <IP>` parameter (requires eleveated privileges).

```powershell
# version and build number
Get-WmiObject -Class win32_OperatingSystem | select Version,BuildNumber
# local processes
Get-WmiObject -Class Win32_Process
# local services
Get-WmiObject -Class Win32_Service
# BIOS
Get-WmiObject -Class Win32_Bios | Format-List -Property *
```

## Permissions

<table><thead><tr><th width="338">Permission</th><th width="356">Description</th></tr></thead><tbody><tr><td>F</td><td>full access</td></tr><tr><td>D</td><td>delete access</td></tr><tr><td>N</td><td>no access</td></tr><tr><td>M</td><td>modify access</td></tr><tr><td>RX</td><td>read and execute access</td></tr><tr><td>R</td><td>read-only access</td></tr><tr><td>W</td><td>write-only acces</td></tr></tbody></table>

```
# check permissions
icacls c:\windows\myfolder
# grant full permissions
icacls c:\windows\myfolder /grant <USER>:f
# remove permissions
icacls c:\users /remove <USER>
```

## Binaries

`strings` with 16-bit encoding for Windows binaries.

```bash
strings -eb <FILE> | grep pass
```
