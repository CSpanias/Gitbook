---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Traffic Capture

## Tools

{% tabs %}
{% tab title="tcpdump" %}
```bash
sudo tcpdump -i any port 53 -n
```
{% endtab %}
{% endtabs %}

## Attack Analysis Example

The SQLi[^1] attack lasted \~8 minutes (Figure 1).

<figure><img src="../.gitbook/assets/wireshark_sqli_duration.png" alt=""><figcaption><p>Figure 1: Duration of the SQLi attack.</p></figcaption></figure>

The attack starts on line 13 (Figure 2).

<figure><img src="../.gitbook/assets/wireshark_sqli_start.png" alt=""><figcaption><p>Figure 2: The start of the SQLi attack.</p></figcaption></figure>

By right-clicking the line and selecting _Follow HTTP Stream_ (Figure 3), _&#x77;_&#x65; can see the raw HTTP requests and that the attacker has entered `1=1` into the `id` parameter to test for SQLi (Figure 4).

<figure><img src="../.gitbook/assets/wireshark_sqli_follow_http_stream.png" alt=""><figcaption><p>Figure 3: Following the HTTP stream.</p></figcaption></figure>

<figure><img src="../.gitbook/assets/wireshark_sqli_1=1.png" alt=""><figcaption><p>Figure 4: Inspecting the HTTP packets.</p></figcaption></figure>

[^1]: Structured Query Language Injection
