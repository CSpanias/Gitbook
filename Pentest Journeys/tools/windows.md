---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Windows

## Whitelisted and writable directories.

{% tabs %}
{% tab title="1. Dirs" %}
{% code overflow="wrap" %}
```powershell
C:\Windows\System32\spool\drivers\color
C:\Windows\Tasks
# similar to \Temp but more stealthy
C:\Users\Public
# all users have rwx
C:\Windows\Temp
# similar to above, but user-only
C:\Users\<user>\AppData\Local\Temp
C:\windows\tracing
C:\Windows\Registration\CRMLog
C:\Windows\System32\FxsTmp
C:\Windows\System32\com\dmp
C:\Windows\System32\Microsoft\Crypto\RSA\MachineKeys
C:\Windows\System32\spool\PRINTERS
C:\Windows\System32\spool\SERVERS
C:\Windows\System32\Tasks\Microsoft\Windows\SyncCenter
C:\Windows\System32\Tasks_Migrated
C:\Windows\SysWOW64\FxsTmp
C:\Windows\SysWOW64\com\dmp
C:\Windows\SysWOW64\Tasks\Microsoft\Windows\SyncCenter
C:\Windows\SysWOW64\Tasks\Microsoft\Windows\PLA\System
```
{% endcode %}
{% endtab %}

{% tab title="2. Test" %}
```powershell
# create a file
echo test > test
# delete the file
del test
```
{% endtab %}
{% endtabs %}

## Interesting Dirs

{% code overflow="wrap" %}
```powershell
# 64-bit appps
GCI 'c:\program files'
# 32-bit apps
GCI 'c:\program files (x86)'
# Keys, hidden folders
GCI C:\Users\User -Force # All dirs and files
GCI C:\Users\User\ -Hidden # Only hidden files
# Config files, temp saves
GCI C:\Users\User\AppData
# History files
GC C:\Users\<USERNAME>\AppData\Roaming\Microsoft\Windows\Powershell\PSReadline\ConsoleHost_history.txt
GC (Get-PSReadlineOption).HistorySavePath
# Clipboard
Get-Clipboard
```
{% endcode %}

## Use another user's credentials

{% code overflow="wrap" %}
```powershell
$user_pass = ConvertTo-SecureString '<PASSWORD>' -AsPlainText -Force
$user_creds = New-Object System.Management.Automation.PSCredential('<DOMAIN\user', $user_pass)
# adding a member to a group
Add-DomainGroupMember -Identity '<GROUP>' -Members '<USER>' -Credential $user_creds -verbose
```
{% endcode %}

```
# check permissions
icacls c:\windows\myfolder
# grant full permissions
icacls c:\windows\myfolder /grant <USER>:f
# remove permissions
icacls c:\users /remove <USER>
```

## Binaries

`strings` with 16-bit encoding for Windows binaries.

```bash
strings -eb <FILE> | grep pass
```
