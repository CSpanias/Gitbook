---
layout:
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
---

# Weak Access Controls

{% hint style="info" %}
Weak Access Controls occur when an application does not properly enforce restrictions on who can access certain resources or perform specific actions.
{% endhint %}

{% hint style="danger" %}
This can allow unauthorized users to access or modify data, perform actions outside their privileges, or exploit sensitive functionality.
{% endhint %}

{% hint style="success" %}
Implement strong access control policies, use role-based or attribute-based access control, enforce permissions at both the application and data levels, and regularly review and test access control mechanisms.
{% endhint %}

## Missing Access Controls <a href="#missing-access-controls" id="missing-access-controls"></a>

> _The example below is based on PostSwigger's_ [_Multi-step process with no access control on one step_](https://portswigger.net/web-security/access-control/lab-multi-step-process-with-no-access-control-on-one-step) _lab._

We first need to log into the app as `administrator` and understand how the process of elevating user privileges work (Figure 1).

<figure><img src="../../.gitbook/assets/web_auth_ac_1.avif" alt=""><figcaption><p>Figure 1: Elevating <code>carlos</code>'s privileges using the <code>administrator</code> account.</p></figcaption></figure>

Next, we can perform some A-B testing to see if proper access controls are in place for all the steps. That is, logging as a non-privileges user (`wiener`) and repeating the same requests we did as `administrator` (Figure 2).

<figure><img src="../../.gitbook/assets/web_auth_ac_2.avif" alt=""><figcaption><p>Figure 2: Performing A-B testing in the user upgrade process.</p></figcaption></figure>

The above process is outlined below using a Delete instead of an Upgrade functionality (Figure 3).

<figure><img src="../../.gitbook/assets/web_auth_ac_3.avif" alt=""><figcaption><p>Figure 3: The process for testing access controls (<em>image taken from</em> <a href="https://academy.tcm-sec.com/p/practical-web-hacking"><em>here</em></a>).</p></figcaption></figure>

## Referer-based Access Controls <a href="#referer-based-access-controls" id="referer-based-access-controls"></a>

> _The example below is based on PostSwigger's_ [_Referer-based access control_](https://portswigger.net/web-security/access-control/lab-referer-based-access-control) _lab._

As before, we will first try to understand how the upgrade functionality works (Figure 4).

<figure><img src="../../.gitbook/assets/web_auth_ac_4.avif" alt=""><figcaption><p>Figure 4: Stepping through the upgrade functionailty as <code>administrator</code>.</p></figcaption></figure>

Both of the steps seems to have proper access control in place (Figure 5).

<figure><img src="../../.gitbook/assets/web_auth_ac_5.avif" alt=""><figcaption><p>Figure 5: Performing A-B testing in the user upgrade process.</p></figcaption></figure>

We can try tampering with the `Referer` header and see if we are able to bypass the current access controls (Figure 6).

<figure><img src="../../.gitbook/assets/web_auth_ac_6.avif" alt=""><figcaption><p>Figure 6: Testing for <code>Referer</code>-based access controls.</p></figcaption></figure>
